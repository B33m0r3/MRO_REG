<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard VLT Carioca</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Bibliotecas externas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --light: #f5f7fa;
            --dark: #2c3e50;
            --border: #e0e6ed;
            --success: #4facfe;
            --danger: #f5576c;
            --warning: #ffa726;
            --info: #29b6f6;
            --azul-linha: #0055A4;
            --verde-linha: #00A651;
            --amarelo-linha: #FFC400;
            --laranja-linha: #F37335;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background:linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            position:relative;
            overflow:hidden;
        }
        body::before {
            content:'';
            position:fixed;
            top:0; left:0;
            width:100%; height:100%;
            background:url('https://www.transparenttextures.com/patterns/cubes.png'), linear-gradient(135deg, rgba(102,126,234,.1) 0%, rgba(118,75,162,.1) 100%);
            z-index:-1;
        }
        .container { display:flex; height:100vh; }
        .sidebar {
            width:280px;
            background:linear-gradient(180deg,#2c3e50 0%,#34495e 100%);
            color:#fff;
            padding:30px 20px;
            overflow-y:auto;
            box-shadow:0 4px 6px rgba(0,0,0,.1);
            transition:width .3s ease;
            position:relative;
            z-index:100;
        }
        .sidebar.collapsed { width:80px; padding:20px 10px; }
        .sidebar.collapsed .nav-label,
        .sidebar.collapsed .logo span { display:none; }
        .sidebar.collapsed .nav-item { justify-content:center; }
        .toggle-sidebar {
            position:absolute;
            top:30px; right:15px;
            background:none;
            border:none;
            color:#fff;
            cursor:pointer;
            font-size:18px;
            transition:transform .3s;
        }
        .sidebar.collapsed .toggle-sidebar { transform:rotate(180deg); }
        .logo {
            font-size:24px;
            font-weight:bold;
            margin-bottom:40px;
            display:flex;
            align-items:center;
            gap:12px;
        }
        .logo i { font-size:32px; color:var(--primary); }
        .nav-menu { list-style:none; }
        .nav-item {
            padding:12px 16px;
            margin:8px 0;
            border-radius:6px;
            cursor:pointer;
            color:rgba(255,255,255,.7);
            transition:all .3s;
            border-left:3px solid transparent;
            display:flex;
            align-items:center;
            gap:12px;
        }
        .nav-item:hover,
        .nav-item.active {
            background:rgba(102,126,234,.2);
            color:#fff;
            border-left-color:var(--primary);
        }
        .nav-item i { width:20px; min-width:20px; }
        .nav-label { display:inline; }
        .main { flex:1; display:flex; flex-direction:column; overflow:hidden; }
        .top-bar {
            background:rgba(255,255,255,.95);
            backdrop-filter:blur(10px);
            padding:15px 30px;
            border-bottom:1px solid var(--border);
            display:flex;
            justify-content:space-between;
            align-items:center;
            box-shadow:0 2px 4px rgba(0,0,0,.05);
        }
        .breadcrumb { color:var(--dark); font-size:16px; font-weight:600; }
        .top-right { display:flex; gap:20px; align-items:center; }
        .screenshot-btn {
            padding:8px 16px;
            background:linear-gradient(135deg, var(--primary), var(--secondary));
            color:#fff;
            border:none;
            border-radius:6px;
            cursor:pointer;
            font-size:14px;
            font-weight:600;
            transition:all .3s;
            display:none;           /* ser√° exibido dinamicamente */
        }
        .screenshot-btn:hover { transform:translateY(-2px); box-shadow:0 4px 12px rgba(102,126,234,.4); }
        .user-profile {
            display:flex;
            align-items:center;
            gap:12px;
            cursor:pointer;
            padding:8px 12px;
            border-radius:6px;
            transition:background .3s;
        }
        .user-profile:hover { background:var(--light); }
        .user-avatar {
            width:40px; height:40px;
            border-radius:50%;
            background:linear-gradient(135deg, var(--primary), var(--secondary));
            display:flex;
            align-items:center;
            justify-content:center;
            color:#fff;
            font-weight:bold;
        }
        .user-info { font-size:13px; }
        .user-name { font-weight:600; color:var(--dark); }
        .user-role { color:#7f8c8d; font-size:11px; }
        .content { flex:1; overflow-y:auto; padding:30px; position:relative; display:flex; flex-direction:column; }
        .pages-wrapper { flex:1; overflow-y:auto; }
        .page { display:none; }
        .page.active { display:block; animation:fadeIn .3s ease; }
        @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
        .page-header { margin-bottom:30px; }
        .page-header h1 { font-size:28px; color:var(--dark); margin-bottom:5px; }
        .page-header p { color:var(--dark); font-size:14px; font-weight:500; }
        /* Loading overlay */
        .loading-overlay {
            position:absolute; top:0; left:0;
            width:100%; height:100%;
            background:rgba(255,255,255,.9);
            display:flex; justify-content:center; align-items:center;
            z-index:999; border-radius:8px;
        }
        .loading-overlay.hidden { display:none; }
        .spinner {
            border:5px solid var(--border);
            border-top:5px solid var(--primary);
            border-radius:50%;
            width:50px; height:50px;
            animation:spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform:rotate(0deg); } 100% { transform:rotate(360deg); } }
        /* Filtros */
        .filter-container {
            display:flex; gap:15px; margin-bottom:20px; flex-wrap:wrap; align-items:center;
        }
        .filter-input, .filter-select {
            padding:10px 15px;
            border:2px solid var(--border);
            border-radius:6px;
            font-size:14px;
            background:#fff;
            transition:border-color .3s;
        }
        .filter-input:focus, .filter-select:focus { outline:none; border-color:var(--primary); }
        .filter-btn {
            padding:10px 20px;
            background:#fff;
            border:2px solid var(--border);
            border-radius:6px;
            cursor:pointer;
            font-weight:600;
            color:var(--dark);
            transition:all .3s;
        }
        .filter-btn:hover,
        .filter-btn.active {
            background:var(--primary);
            color:#fff;
            border-color:var(--primary);
        }
        /* Tabelas */
        .table-container {
            background:rgba(255,255,255,.95);
            backdrop-filter:blur(10px);
            border-radius:8px;
            overflow-x:auto;
            box-shadow:0 2px 8px rgba(0,0,0,.08);
            margin-bottom:20px;
        }
        table { width:100%; border-collapse:collapse; font-size:13px; }
        thead { background:var(--light); }
        th, td { padding:12px 15px; border-bottom:1px solid var(--border); }
        th { font-weight:600; color:var(--dark); border-bottom:2px solid var(--border); }
        tr:hover { background:var(--light); }
        /* Bot√µes prim√°rios */
        .btn-primary {
            padding:15px 30px;
            background:linear-gradient(135deg, var(--primary), var(--secondary));
            color:#fff;
            border:none;
            border-radius:6px;
            cursor:pointer;
            font-weight:600;
            transition:all .3s;
            text-decoration:none;
            display:inline-block;
            font-size:16px;
        }
        .btn-primary:hover { transform:translateY(-2px); }
        .btn-primary i { margin-right:8px; }
        /* Modais */
        .modal {
            display:none;
            position:fixed;
            top:0; left:0;
            width:100%; height:100%;
            background:rgba(0,0,0,.5);
            z-index:1000;
            justify-content:center;
            align-items:center;
            backdrop-filter:blur(5px);
        }
        .modal.show { display:flex; animation:fadeIn .3s ease; }
        .modal-content {
            background:#fff;
            border-radius:15px;
            padding:40px;
            max-width:600px;
            width:90%;
            box-shadow:0 20px 60px rgba(0,0,0,.3);
            position:relative;
            max-height:80vh;
            overflow-y:auto;
        }
        .modal-close {
            position:absolute;
            top:15px; right:15px;
            background:none;
            border:none;
            font-size:28px;
            cursor:pointer;
            color:#bdc3c7;
            transition:color .3s;
        }
        .modal-close:hover { color:var(--dark); }
        .modal-title { font-size:24px; font-weight:600; margin-bottom:30px; color:var(--dark); }
        .modal-section { margin-bottom:25px; }
        .modal-label {
            font-size:12px; color:#7f8c8d; font-weight:600;
            text-transform:uppercase; margin-bottom:8px;
        }
        .modal-value { font-size:16px; color:var(--dark); font-weight:600; }
        .modal-link {
            display:inline-block; color:var(--primary);
            text-decoration:none; cursor:pointer; font-weight:600;
        }
        .modal-link:hover { color:var(--secondary); }
        /* Plant√£o */
        .plantao-container {
            background:rgba(255,255,255,.95);
            backdrop-filter:blur(10px);
            border-radius:12px;
            padding:25px;
            box-shadow:0 4px 15px rgba(0,0,0,.1);
            margin-bottom:20px;
        }
        .plantao-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
        .plantao-title { font-size:24px; font-weight:600; color:var(--dark); }
        .plantao-date-selector { display:flex; align-items:center; gap:15px; }
        .plantao-date-input {
            padding:10px 15px;
            border:2px solid var(--border);
            border-radius:6px;
            font-size:16px;
            transition:border-color .3s;
        }
        .plantao-date-input:focus { outline:none; border-color:var(--primary); }
        .plantao-info { display:flex; justify-content:space-between; margin-bottom:30px; }
        .plantao-shift {
            flex:1;
            padding:20px;
            border-radius:8px;
            text-align:center;
            transition:transform .3s;
            cursor:pointer;
        }
        .plantao-shift:hover { transform:translateY(-5px); }
        .plantao-diurno {
            background:linear-gradient(135deg,#FFC400,#FFD54F);
            color:#333;
            margin-right:10px;
        }
        .plantao-noturno {
            background:linear-gradient(135deg,#0055A4,#1976D2);
            color:#fff;
            margin-left:10px;
        }
        .plantao-shift-title { font-size:18px; font-weight:600; margin-bottom:10px; }
        .plantao-shift-time { font-size:14px; margin-bottom:15px; opacity:.8; }
        .plantao-shift-group { font-size:20px; font-weight:700; padding:10px; border-radius:6px; background:rgba(255,255,255,.2); }
        .plantao-calendar {
            background:#fff;
            border-radius:8px;
            padding:20px;
            box-shadow:0 2px 8px rgba(0,0,0,.05);
        }
        .calendar-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
        .calendar-title { font-size:18px; font-weight:600; color:var(--dark); }
        .calendar-nav { display:flex; gap:10px; }
        .calendar-btn {
            width:36px; height:36px;
            border-radius:50%;
            background:var(--light);
            border:none;
            color:var(--dark);
            cursor:pointer;
            display:flex; align-items:center; justify-content:center;
            transition:all .3s;
        }
        .calendar-btn:hover { background:var(--primary); color:#fff; }
        .calendar-grid {
            display:grid;
            grid-template-columns:repeat(7,1fr);
            gap:10px;
        }
        .calendar-day-header {
            text-align:center;
            font-weight:600;
            color:var(--dark);
            padding:10px 0;
        }
        .calendar-day {
            position:relative;
            aspect-ratio:1;
            border-radius:8px;
            background:var(--light);
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            cursor:pointer;
            transition:all .3s;
        }
        .calendar-day:hover { transform:translateY(-3px); box-shadow:0 4px 8px rgba(0,0,0,.1); }
        .calendar-day-number { font-weight:600; margin-bottom:5px; }
        .calendar-day-shifts { display:flex; width:100%; height:6px; }
        .calendar-day-diurno {
            width:50%; background:#FFC400;
            border-radius:3px 0 0 3px;
        }
        .calendar-day-noturno {
            width:50%; background:#0055A4;
            border-radius:0 3px 3px 0;
        }
        .calendar-day.other-month { opacity:.3; }
        .calendar-day.today,
        .calendar-day.selected {
            border:2px solid var(--primary);
        }
        .calendar-day.selected { box-shadow:0 0 0 3px rgba(102,126,234,.2); }
        /* Modal da equipe (hover/click) */
        .team-modal {
            display:none;
            position:fixed;
            top:0; left:0;
            width:100%; height:100%;
            background:rgba(0,0,0,.5);
            z-index:1000;
            justify-content:center;
            align-items:center;
            backdrop-filter:blur(5px);
        }
        .team-modal.show { display:flex; animation:fadeIn .3s ease; }
        .team-modal-content {
            background:#fff;
            border-radius:15px;
            padding:30px;
            max-width:500px;
            width:90%;
            box-shadow:0 20px 60px rgba(0,0,0,.3);
            position:relative;
        }
        .team-modal-header { display:flex; align-items:center; margin-bottom:20px; }
        .team-modal-icon {
            width:50px; height:50px;
            border-radius:50%;
            display:flex;
            align-items:center;
            justify-content:center;
            margin-right:15px;
            color:#fff;
            font-size:24px;
        }
        .team-modal-icon.diurno { background:linear-gradient(135deg,#FFC400,#FFD54F); }
        .team-modal-icon.noturno { background:linear-gradient(135deg,#0055A4,#1976D2); }
        .team-modal-title { font-size:24px; font-weight:600; color:var(--dark); }
        .team-modal-subtitle { font-size:14px; color:#7f8c8d; margin-top:5px; }
        .team-members { margin-top:20px; }
        .team-member {
            display:flex; align-items:center;
            padding:12px 0;
            border-bottom:1px solid var(--border);
        }
        .team-member:last-child { border-bottom:none; }
        .member-avatar {
            width:40px; height:40px;
            border-radius:50%;
            background:var(--light);
            display:flex; align-items:center; justify-content:center;
            margin-right:15px;
            color:var(--dark);
            font-weight:600;
        }
        .member-info { flex:1; }
        .member-name { font-weight:600; color:var(--dark); }
        .member-role { font-size:12px; color:#7f8c8d; }
        /* Programa√ß√£o Semanal */
        .programacao-container {
            background:rgba(255,255,255,.95);
            backdrop-filter:blur(10px);
            border-radius:12px;
            padding:25px;
            box-shadow:0 4px 15px rgba(0,0,0,.1);
            margin-bottom:20px;
        }
        .programacao-header {
            display:flex; justify-content:space-between; align-items:center;
            margin-bottom:20px;
        }
        .programacao-title { font-size:24px; font-weight:600; color:var(--dark); }
        .programacao-actions { display:flex; gap:10px; }
        .programacao-iframe-container {
            width:100%; height:600px;
            border-radius:8px;
            overflow:auto;                /* rolagem nas duas dire√ß√µes */
            box-shadow:0 2px 8px rgba(0,0,0,.08);
            position:relative;
        }
        .programacao-iframe {
            width:100%; height:100%; border:none;
        }
        /* Documenta√ß√£o */
        .documents-container {
            display:grid;
            grid-template-columns:repeat(auto-fill, minmax(300px,1fr));
            gap:20px;
            margin-top:20px;
        }
        .document-card {
            background:rgba(255,255,255,.95);
            backdrop-filter:blur(10px);
            border-radius:12px;
            padding:20px;
            box-shadow:0 4px 15px rgba(0,0,0,.1);
            transition:all .3s ease;
            border-left:4px solid var(--primary);
            cursor:pointer;
        }
        .document-card:hover { transform:translateY(-5px); box-shadow:0 8px 25px rgba(0,0,0,.15); }
        .document-icon { font-size:32px; color:var(--primary); margin-bottom:15px; }
        .document-title { font-size:16px; font-weight:600; color:var(--dark); margin-bottom:8px; line-height:1.4; }
        .document-info { font-size:12px; color:#7f8c8d; margin-bottom:15px; }
        .document-actions { display:flex; gap:10px; }
        .document-btn {
            padding:8px 16px; border:none; border-radius:6px;
            cursor:pointer; font-size:12px; font-weight:600;
            flex:1; text-align:center; transition:all .3s;
        }
        .document-btn.view { background:var(--primary); color:#fff; }
        .document-btn.download { background:var(--success); color:#fff; }
        .document-btn:hover { transform:translateY(-2px); }
        /* Sobre */
        .sobre-container { display:flex; gap:30px; }
        .sobre-info { flex:1; }
        .info-card {
            background:rgba(255,255,255,.95);
            backdrop-filter:blur(10px);
            padding:20px;
            border-radius:8px;
            margin-bottom:20px;
            box-shadow:0 2px 8px rgba(0,0,0,.05);
        }
        .info-card h3 { color:var(--dark); margin-bottom:15px; }
        .info-card p { color:#555; line-height:1.6; }
        .search-box { width:100%; padding:12px; border:2px solid var(--border); border-radius:6px; font-size:14px; margin-bottom:20px; }
        .linha-btn {
            padding:10px 15px; border:none; border-radius:6px;
            color:#fff; font-weight:600; cursor:pointer; margin:5px;
            transition:transform .2s;
        }
        .linha-btn:hover { transform:scale(1.05); }
        .linha-azul { background-color:var(--azul-linha); }
        .linha-verde { background-color:var(--verde-linha); }
        .linha-amarela { background-color:var(--amarelo-linha); }
        .linha-laranja { background-color:var(--laranja-linha); }
        .estacoes-list { max-height:200px; overflow-y:auto; border:1px solid var(--border); border-radius:6px; padding:10px; }
        .estacao-item { padding:8px; border-bottom:1px solid #eee; cursor:pointer; transition:background .2s; }
        .estacao-item:hover { background:var(--light); }
        .estacao-item.highlight { background:#fff3cd; font-weight:bold; }
        /* Rel√≥gio de opera√ß√£o */
        .operation-clock {
            background:linear-gradient(135deg,var(--primary),var(--secondary));
            color:#fff;
            padding:25px;
            border-radius:12px;
            text-align:center;
            margin-bottom:30px;
            box-shadow:0 4px 15px rgba(0,0,0,.2);
        }
        .operation-clock h2 { font-size:20px; margin-bottom:10px; font-weight:700; }
        .clock-display { font-size:28px; font-weight:700; font-family:'Courier New',Courier,monospace; }
        .clock-display span { margin:0 5px; }
        /* Motivational quote */
        .motivational-quote {
            margin-top:auto;
            padding-top:30px;
            border-top:2px solid var(--border);
            text-align:center;
            color:var(--dark);
            font-style:italic;
            font-size:16px;
            font-weight:600;
            min-height:40px;
            display:flex;
            align-items:center;
            justify-content:center;
            background:rgba(255,255,255,.5);
            border-radius:8px;
        }
        @media (max-width:768px) {
            .top-bar { padding:12px 15px; }
            .screenshot-btn { padding:6px 12px; font-size:12px; }
            .user-info { display:none; }
            .content { padding:15px; }
            .page-header h1 { font-size:20px; }
            .filter-container { flex-direction:column; }
            .filter-btn { width:100%; }
            .sobre-container { flex-direction:column; }
            .documents-container { grid-template-columns:1fr; }
            .form-iframe { height:600px; }
            .programacao-iframe-container { height:400px; }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- ==================== SIDEBAR ==================== -->
    <aside class="sidebar">
        <button class="toggle-sidebar" onclick="toggleSidebar()">‚óÄ</button>
        <div class="logo">
            <i class="fas fa-train"></i>
            <span>VLT Carioca</span>
        </div>
        <ul class="nav-menu">
            <li class="nav-item active" onclick="showPage('dashboard',event)">
                <i class="fas fa-chart-line"></i>
                <span class="nav-label">Dashboard</span>
            </li>
            <li class="nav-item" onclick="showPage('plantao',event)">
                <i class="fas fa-calendar-alt"></i>
                <span class="nav-label">Plant√£o</span>
            </li>
            <li class="nav-item" onclick="showPage('passagem',event)">
                <i class="fas fa-clipboard-list"></i>
                <span class="nav-label">Passagem de Servi√ßo</span>
            </li>
            <li class="nav-item" onclick="showPage('novo_registro',event)">
                <i class="fas fa-plus-circle"></i>
                <span class="nav-label">Novo Registro</span>
            </li>
            <li class="nav-item" onclick="showPage('usuarios',event)" id="usuarios-menu">
                <i class="fas fa-users"></i>
                <span class="nav-label">Usu√°rios</span>
            </li>
            <li class="nav-item" onclick="showPage('laboratorio',event)">
                <i class="fas fa-flask"></i>
                <span class="nav-label">Laborat√≥rio</span>
            </li>
            <li class="nav-item" onclick="showPage('eva',event)">
                <i class="fas fa-robot"></i>
                <span class="nav-label">EVA</span>
            </li>
            <li class="nav-item" onclick="showPage('refrigeracao',event)">
                <i class="fas fa-snowflake"></i>
                <span class="nav-label">Refrigera√ß√£o</span>
            </li>
            <li class="nav-item" onclick="showPage('rastreabilidade',event)">
                <i class="fas fa-route"></i>
                <span class="nav-label">Rastreabilidade</span>
            </li>
            <li class="nav-item" onclick="showPage('programacao',event)">
                <i class="fas fa-calendar-week"></i>
                <span class="nav-label">Programa√ß√£o Semanal</span>
            </li>
            <li class="nav-item" onclick="showPage('documentacao',event)">
                <i class="fas fa-book"></i>
                <span class="nav-label">Documenta√ß√£o</span>
            </li>
            <li class="nav-item" onclick="showPage('sobre',event)">
                <i class="fas fa-info-circle"></i>
                <span class="nav-label">Sobre o VLT</span>
            </li>
            <li class="nav-item" onclick="openSupportModal()">
                <i class="fas fa-headset"></i>
                <span class="nav-label">Suporte</span>
            </li>
        </ul>
    </aside>

    <!-- ==================== MAIN ==================== -->
    <main class="main">
        <div class="top-bar">
            <div class="breadcrumb" id="breadcrumb">üìä Dashboard</div>
            <div class="top-right">
                <button class="screenshot-btn" id="screenshotBtn" onclick="takeScreenshot()">
                    <i class="fas fa-camera"></i> Screenshot
                </button>
                <div class="user-profile" onclick="openProfileModal()">
                    <div class="user-avatar" id="userInitials">??</div>
                    <div class="user-info">
                        <div class="user-name" id="userName">Carregando...</div>
                        <div class="user-role" id="userRole">...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content">
            <div class="pages-wrapper">

                <!-- ==================== DASHBOARD ==================== -->
                <div class="page active" id="page-dashboard">
                    <div class="cards-container" id="dashboard-cards"></div>
                    <div style="width:100%;height:600px;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.08);margin-bottom:20px;position:relative;">
                        <div class="loading-overlay" id="loading-looker">
                            <div class="spinner"></div>
                        </div>
                        <iframe src="https://lookerstudio.google.com/embed/reporting/95cf4b2a-b4ef-4aa1-910c-423461799e6c"
                                frameborder="0"
                                style="border:0;width:100%;height:100%;"
                                onload="document.getElementById('loading-looker').classList.add('hidden')"
                                allowfullscreen
                                aria-hidden="false"
                                tabindex="0"></iframe>
                    </div>
                </div>

                <!-- ==================== PLANT√ÉO ==================== -->
                <div class="page" id="page-plantao">
                    <div class="page-header">
                        <h1>üìÖ Plant√£o</h1>
                        <p>Visualiza√ß√£o da escala de trabalho 2x2</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <button class="btn-primary" onclick="takePageScreenshot('plantao')">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="plantao-container">
                        <div class="plantao-header">
                            <div class="plantao-title">Escala de Plant√£o</div>
                            <div class="plantao-date-selector">
                                <input type="date" id="plantao-date" class="plantao-date-input" onchange="updatePlantaoInfo()">
                                <button class="btn-primary" onclick="setTodayDate()">Hoje</button>
                            </div>
                        </div>
                        <div class="plantao-info">
                            <div class="plantao-shift plantao-diurno" onclick="showTeamDetails('diurno')">
                                <div class="plantao-shift-title">Turno Diurno</div>
                                <div class="plantao-shift-time">06:00 - 18:00</div>
                                <div class="plantao-shift-group" id="diurno-group">GRUPO B</div>
                            </div>
                            <div class="plantao-shift plantao-noturno" onclick="showTeamDetails('noturno')">
                                <div class="plantao-shift-title">Turno Noturno</div>
                                <div class="plantao-shift-time">18:00 - 06:00</div>
                                <div class="plantao-shift-group" id="noturno-group">GRUPO C</div>
                            </div>
                        </div>
                        <div class="plantao-calendar">
                            <div class="calendar-header">
                                <div class="calendar-title" id="calendar-title">Novembro 2023</div>
                                <div class="calendar-nav">
                                    <button class="calendar-btn" onclick="changeMonth(-1)"><i class="fas fa-chevron-left"></i></button>
                                    <button class="calendar-btn" onclick="changeMonth(1)"><i class="fas fa-chevron-right"></i></button>
                                </div>
                            </div>
                            <div class="calendar-grid" id="calendar-grid">
                                <!-- Calend√°rio gerado por JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ==================== PASSAGEM DE SERVI√áO ==================== -->
                <div class="page" id="page-passagem">
                    <div class="page-header">
                        <h1>üìã Passagem de Servi√ßo</h1>
                        <p>Resumo do plant√£o. Use o filtro para carregar os dados corretos.</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <button class="btn-primary" onclick="openPassagemFilterModal()">
                            <i class="fas fa-filter"></i> Filtrar Passagem de Servi√ßo
                        </button>
                        <a href="https://docs.google.com/spreadsheets/d/13G8eUT2m35aoWsqpIu3OTKUdg0L2sdjEl0GTXfPEg50/edit?usp=sharing"
                           target="_blank"
                           class="btn-primary"
                           style="margin-left:10px;">
                            <i class="fas fa-table"></i> Acessar Planilha
                        </a>
                        <button class="btn-primary" onclick="takePassagemScreenshot()" style="margin-left:10px;">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="filter-container" id="passagem-filters" style="display:none;">
                        <input type="date" id="passagemData" class="filter-input" placeholder="Selecione a data">
                        <select id="passagemGrupo" class="filter-select">
                            <option value="">Todos Grupos</option>
                            <option value="GRUPO A">GRUPO A</option>
                            <option value="GRUPO B">GRUPO B</option>
                            <option value="GRUPO C">GRUPO C</option>
                            <option value="GRUPO D">GRUPO D</option>
                        </select>
                        <input type="text" id="passagemTrem" class="filter-input" placeholder="N√∫mero do Trem">
                        <input type="text" id="passagemSistema" class="filter-input" placeholder="Sistema">
                        <input type="text" id="passagemTecnico" class="filter-input" placeholder="T√©cnico">
                        <select id="passagemStatus" class="filter-select">
                            <option value="">Todos Status</option>
                            <option value="LIBERADO">LIBERADO</option>
                            <option value="MANUTEN√á√ÉO">MANUTEN√á√ÉO</option>
                            <option value="AGENDADO">AGENDADO</option>
                            <option value="COLIS√ÉO">COLIS√ÉO</option>
                            <option value="PREVENTIVA">PREVENTIVA</option>
                        </select>
                        <button class="filter-btn" onclick="applyPassagemFilters()">
                            <i class="fas fa-filter"></i> Aplicar Filtros
                        </button>
                        <button class="filter-btn" onclick="clearPassagemFilters()">
                            <i class="fas fa-times"></i> Limpar
                        </button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Data/Hora</th>
                                    <th>T√©cnico</th>
                                    <th>Trem</th>
                                    <th>Sistema</th>
                                    <th>Descri√ß√£o</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="passagem-table">
                                <tr><td colspan="7" style="text-align:center;padding:40px;">Clique no bot√£o "Filtrar Passagem de Servi√ßo" para carregar os dados.</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ==================== NOVO REGISTRO ==================== -->
                <div class="page" id="page-novo_registro">
                    <div class="page-header">
                        <h1>‚ûï Novo Registro</h1>
                        <p>Registre uma nova falha ou evento no sistema</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vTI602SZCvv3Vljbau78ZXFxNxUVQATWF1aefTd0rxh6zXpmhV9nDjmpimnDO5vkHLKpWZl82Kw4Gu2/pub?gid=195449004&single=true&output=csv"
                           target="_blank"
                           class="btn-primary">
                            <i class="fas fa-table"></i> Acessar Planilha
                        </a>
                        <button class="btn-primary" onclick="takePageScreenshot('novo_registro')" style="margin-left:10px;">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="form-container">
                        <div class="loading-overlay" id="loading-novo_registro"><div class="spinner"></div></div>
                        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSdz056J8dsQMPXV6__U2B-VOxQEaNF34bwyaRgFVlcCKOLZ_Q/viewform?embedded=true"
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-novo_registro')"
                                onerror="handleIframeError('page-novo_registro','https://docs.google.com/forms/d/e/1FAIpQLSdz056J8dsQMPXV6__U2B-VOxQEaNF34bwyaRgFVlcCKOLZ_Q/viewform')">
                        </iframe>
                    </div>
                </div>

                <!-- ==================== USU√ÅRIOS ==================== -->
                <div class="page" id="page-usuarios">
                    <div class="page-header">
                        <h1>üë• Usu√°rios do Sistema</h1>
                        <p>Lista de usu√°rios cadastrados e seus perfis</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <!-- Bot√£o ‚ÄúAcessar Planilha‚Äù removido conforme solicitado -->
                        <button class="btn-primary" onclick="takePageScreenshot('usuarios')" style="margin-left:10px;">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Usu√°rio</th>
                                    <th>Nome</th>
                                    <th>Email</th>
                                    <th>Telefone</th>
                                    <th>Tipo</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="usuarios-table">
                                <tr><td colspan="6" style="text-align:center;padding:40px;" class="loading">‚è≥ Carregando usu√°rios‚Ä¶</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ==================== LABORAT√ìRIO ==================== -->
                <div class="page" id="page-laboratorio">
                    <div class="page-header">
                        <h1>üî¨ Laborat√≥rio</h1>
                        <p>Registros e atividades da equipe de laborat√≥rio</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=43329994&single=true&output=csv"
                           target="_blank"
                           class="btn-primary">
                            <i class="fas fa-table"></i> Acessar Planilha
                        </a>
                        <button class="btn-primary" onclick="takePageScreenshot('laboratorio')" style="margin-left:10px;">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="form-container">
                        <div class="loading-overlay" id="loading-laboratorio"><div class="spinner"></div></div>
                        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeX0zKXBJXX3SyCkJGHufqbEDlTnpRigdZq0TmBqdLmC3woGQ/viewform?embedded=true"
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-laboratorio')"
                                onerror="handleIframeError('page-laboratorio','https://docs.google.com/forms/d/e/1FAIpQLSeX0zKXBJXX3SyCkJGHufqbEDlTnpRigdZq0TmBqdLmC3woGQ/viewform')">
                        </iframe>
                    </div>
                </div>

                <!-- ==================== EVA ==================== -->
                <div class="page" id="page-eva">
                    <div class="page-header">
                        <h1>ü§ñ EVA</h1>
                        <p>Registros e atividades da equipe EVA</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=927195938&single=true&output=csv"
                           target="_blank"
                           class="btn-primary">
                            <i class="fas fa-table"></i> Acessar Planilha
                        </a>
                        <button class="btn-primary" onclick="takePageScreenshot('eva')" style="margin-left:10px;">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="form-container">
                        <div class="loading-overlay" id="loading-eva"><div class="spinner"></div></div>
                        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeixWIcnMdFmqHnxwO-vb2F86AKW6g6KRqDwMsYTk3Baj6l8w/viewform?embedded=true"
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-eva')"
                                onerror="handleIframeError('page-eva','https://docs.google.com/forms/d/e/1FAIpQLSeixWIcnMdFmqHnxwO-vb2F86AKW6g6KRqDwMsYTk3Baj6l8w/viewform')">
                        </iframe>
                    </div>
                </div>

                <!-- ==================== REFRIGERA√á√ÉO ==================== -->
                <div class="page" id="page-refrigeracao">
                    <div class="page-header">
                        <h1>‚ùÑÔ∏è Refrigera√ß√£o</h1>
                        <p>Registros e atividades da equipe de refrigera√ß√£o</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=131107120&single=true&output=csv"
                           target="_blank"
                           class="btn-primary">
                            <i class="fas fa-table"></i> Acessar Planilha
                        </a>
                        <button class="btn-primary" onclick="takePageScreenshot('refrigeracao')" style="margin-left:10px;">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="form-container">
                        <div class="loading-overlay" id="loading-refrigeracao"><div class="spinner"></div></div>
                        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSekQ4e_rCSuzitRhtpjq48VR2ttobQvvRr--e0qcTH5PU9azQ/viewform?embedded=true"
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-refrigeracao')"
                                onerror="handleIframeError('page-refrigeracao','https://docs.google.com/forms/d/e/1FAIpQLSekQ4e_rCSuzitRhtpjq48VR2ttobQvvRr--e0qcTH5PU9azQ/viewform')">
                        </iframe>
                    </div>
                </div>

                <!-- ==================== RASTREABILIDADE ==================== -->
                <div class="page" id="page-rastreabilidade">
                    <div class="page-header">
                        <h1>üõ£Ô∏è Rastreabilidade</h1>
                        <p>Registros e atividades de rastreabilidade</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=500914835&single=true&output=csv"
                           target="_blank"
                           class="btn-primary">
                            <i class="fas fa-table"></i> Acessar Planilha
                        </a>
                        <button class="btn-primary" onclick="takePageScreenshot('rastreabilidade')" style="margin-left:10px;">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="form-container">
                        <div class="loading-overlay" id="loading-rastreabilidade"><div class="spinner"></div></div>
                        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSciTNSHCOzWsFK0GBQv-GKTqgb5WtijzfaG4azAMyIvcU0Vnw/viewform?embedded=true"
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-rastreabilidade')"
                                onerror="handleIframeError('page-rastreabilidade','https://docs.google.com/forms/d/e/1FAIpQLSciTNSHCOzWsFK0GBQv-GKTqgb5WtijzfaG4azAMyIvcU0Vnw/viewform')">
                        </iframe>
                    </div>
                </div>

                <!-- ==================== PROGRAMA√á√ÉO SEMANAL ==================== -->
                <div class="page" id="page-programacao">
                    <div class="page-header">
                        <h1>üìÖ Programa√ß√£o Semanal</h1>
                        <p>Visualiza√ß√£o da programa√ß√£o semanal de atividades</p>
                    </div>
                    <div style="margin-bottom:20px;">
                        <button class="btn-primary" onclick="takePageScreenshot('programacao')">
                            <i class="fas fa-camera"></i> Capturar Tela
                        </button>
                    </div>
                    <div class="programacao-container">
                        <div class="programacao-header">
                            <div class="programacao-title">Programa√ß√£o Semanal</div>
                            <div class="programacao-actions">
                                <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vTI602SZCvv3Vljbau78ZXFxNxUVQATWF1aefTd0rxh6zXpmhV9nDjmpimnDO5vkHLKpWZl82Kw4Gu2/pubhtml?gid=1888450540&single=true"
                                   target="_blank"
                                   class="btn-primary">
                                    <i class="fas fa-external-link-alt"></i> Abrir em Nova Aba
                                </a>
                            </div>
                        </div>
                        <div class="programacao-iframe-container">
                            <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTI602SZCvv3Vljbau78ZXFxNxUVQATWF1aefTd0rxh6zXpmhV9nDjmpimnDO5vkHLKpWZl82Kw4Gu2/pubhtml?gid=1888450540&single=true"
                                    class="programacao-iframe"
                                    allowfullscreen
                                    loading="lazy">
                            </iframe>
                        </div>
                    </div>
                </div>

                <!-- ==================== DOCUMENTA√á√ÉO ==================== -->
                <div class="page" id="page-documentacao">
                    <div class="page-header">
                        <h1>üìí Documenta√ß√£o</h1>
                        <p>Manuais, procedimentos e documenta√ß√µes t√©cnicas</p>
                    </div>
                    <div class="filter-container">
                        <input type="text" id="searchDocumentacao" class="filter-input" placeholder="üîç Buscar documento‚Ä¶" onkeyup="filterDocuments()">
                        <button class="filter-btn" onclick="clearDocumentSearch()"><i class="fas fa-times"></i> Limpar</button>
                    </div>
                    <div class="documents-container" id="documents-list">
                        <div style="text-align:center;padding:40px;color:#666;">
                            <i class="fas fa-spinner fa-spin"></i> Carregando documentos‚Ä¶
                        </div>
                    </div>
                </div>

                <!-- ==================== SOBRE O VLT ==================== -->
                <div class="page" id="page-sobre">
                    <div class="page-header">
                        <h1>‚ÑπÔ∏è Sobre o VLT Carioca</h1>
                        <p>Informa√ß√µes t√©cnicas e mapa da rede</p>
                    </div>
                    <div class="operation-clock">
                        <h2>‚è±Ô∏è Tempo de Opera√ß√£o Cont√≠nuo</h2>
                        <div class="clock-display" id="operation-clock">
                            <span id="op-years">0</span>anos
                            <span id="op-months">0</span>meses
                            <span id="op-days">0</span>dias
                            <span id="op-hours">0</span>h
                            <span id="op-minutes">0</span>m
                            <span id="op-seconds">0</span>s
                        </div>
                    </div>
                    <div class="sobre-container">
                        <div class="sobre-info">
                            <div class="info-card">
                                <h3>Buscar Esta√ß√£o</h3>
                                <input type="text" id="searchEstacao" class="search-box"
                                       placeholder="Digite o nome ou sigla da esta√ß√£o‚Ä¶" onkeyup="searchStation()">
                                <div id="estacao-result"></div>
                            </div>
                            <div class="info-card">
                                <h3>Explorar Linhas</h3>
                                <button class="linha-btn linha-azul" onclick="showLineStations(1)">üîµ Linha 1 (Azul)</button>
                                <button class="linha-btn linha-verde" onclick="showLineStations(2)">üü¢ Linha 2 (Verde)</button>
                                <button class="linha-btn linha-amarela" onclick="showLineStations(3)">üü° Linha 3 (Amarela)</button>
                                <button class="linha-btn linha-laranja" onclick="showLineStations(4)">üü† Linha 4 (Laranja)</button>
                                <div id="linhas-list" class="estacoes-list" style="display:none;"></div>
                            </div>
                            <div class="info-card">
                                <h3>Dados T√©cnicos</h3>
                                <p><strong>Fabricante:</strong> Alstom</p>
                                <p><strong>Modelo:</strong> Citadis¬†402</p>
                                <p><strong>Alimenta√ß√£o:</strong> 750‚ÄØV‚ÄØCC (APS e SRS)</p>
                                <p><strong>Peso Vazio:</strong> 60‚ÄØ000‚ÄØkg (60‚ÄØt)</p>
                                <p><strong>Peso em Opera√ß√£o:</strong> 82‚ÄØ000‚ÄØkg</p>
                                <p><strong>Velocidade M√°xima:</strong> ~70‚ÄØkm/h</p>
                                <p><strong>Inaugura√ß√£o:</strong> 05/06/2016</p>
                                <p><strong>Op. Comercial:</strong> 06/06/2016</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div> <!-- end .pages-wrapper -->

            <div class="motivational-quote" id="motivational-quote">
                üí™ Excel√™ncia √© a jornada, n√£o o destino!
            </div>
        </div> <!-- end .content -->
    </main>
</div>

<!-- ==================== MODAIS ==================== -->

<!-- Perfil -->
<div id="profileModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeProfileModal()">‚úï</button>
        <div class="modal-title">üë§ Meu Perfil</div>
        <div class="modal-section">
            <div class="modal-label">Nome Completo</div>
            <div class="modal-value" id="perfil-nome">-</div>
        </div>
        <div class="modal-section">
            <div class="modal-label">Usu√°rio</div>
            <div class="modal-value" id="perfil-usuario">-</div>
        </div>
        <div class="modal-section">
            <div class="modal-label">Email</div>
            <div class="modal-value" id="perfil-email">-</div>
        </div>
        <div class="modal-section">
            <div class="modal-label">Telefone / WhatsApp</div>
            <div class="modal-value" id="perfil-telefone">-</div>
        </div>
        <div class="modal-section">
            <div class="modal-label">Tipo</div>
            <div class="modal-value" id="perfil-tipo">-</div>
        </div>
        <div class="modal-section">
            <div class="modal-label">Status</div>
            <div class="modal-value" id="perfil-status">-</div>
        </div>
        <div class="modal-section">
            <div class="modal-label">A√ß√µes</div>
            <div class="modal-value">
                <a href="#" class="modal-link" onclick="editProfile()">Editar Perfil</a> |
                <a href="#" class="modal-link" onclick="changePassword()">Alterar Senha</a> |
                <a href="#" class="modal-link" onclick="logout()">Sair</a>
            </div>
        </div>
    </div>
</div>

<!-- Suporte -->
<div id="supportModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeSupportModal()">‚úï</button>
        <div class="modal-title">üéß Suporte T√©cnico</div>
        <div class="modal-section">
            <div class="modal-label">Contato Direto</div>
            <div class="modal-value">
                <p><i class="fas fa-phone"></i> (21) 1234‚Äë5678</p>
                <p><i class="fab fa-whatsapp"></i> (21) 98765‚Äë4321</p>
            </div>
        </div>
        <div class="modal-section">
            <div class="modal-label">Email</div>
            <div class="modal-value">suporte@vltcarioca.rj.gov.br</div>
        </div>
        <div class="modal-section">
            <div class="modal-label">Hor√°rio de Atendimento</div>
            <div class="modal-value">Segunda a Sexta, das 08:00 √†s 18:00</div>
        </div>
        <div class="modal-section">
            <div class="modal-label">Abrir Chamado</div>
            <div class="modal-value">
                <a href="#" class="modal-link" onclick="openTicketForm()">Clique aqui para abrir um chamado</a>
            </div>
        </div>
    </div>
</div>

<!-- Equipe (turno) -->
<div id="teamModal" class="team-modal">
    <div class="team-modal-content">
        <button class="modal-close" onclick="closeTeamModal()">‚úï</button>
        <div class="team-modal-header">
            <div class="team-modal-icon" id="team-modal-icon"><i class="fas fa-users"></i></div>
            <div>
                <div class="team-modal-title" id="team-modal-title">GRUPO B</div>
                <div class="team-modal-subtitle" id="team-modal-subtitle">Turno Diurno</div>
            </div>
        </div>
        <div class="team-members" id="team-members">
            <!-- preenchido dinamicamente -->
        </div>
    </div>
</div>

<script>
    /* ==========================================================
       VARI√ÅVEIS GLOBAIS
    =========================================================== */
    let currentPage = 'dashboard';
    let calendarMonth = new Date().getMonth();   // 0‚Äë11
    let calendarYear = new Date().getFullYear();
    let selectedDate = new Date();              // hoje (padr√£o)
    let teamData = {};                           // ser√° preenchido por loadTeamData()
    let usersData = [];                          // ser√° preenchido por loadUsers()
    const baseDate = new Date('2025-11-24');      // Marco zero da escala 2x2

    /* ==========================================================
       INICIALIZA√á√ÉO
    =========================================================== */
    document.addEventListener('DOMContentLoaded', () => {
        console.log('--- Dashboard inicializado ---');

        // Carrega equipes, usu√°rios, documentos, rel√≥gio etc.
        loadTeamData().then(() => {
            setTodayDate();      // define data de hoje no campo de data
            updatePlantaoInfo();
            generateCalendar();
        });
        loadUsers();            // preenche a tabela e o perfil
        loadDocuments();        // carrega PDFs da pasta pdf/
        startOperationClock();  // rel√≥gio cont√≠nuo

        // Mostra/oculta bot√£o de captura conforme p√°gina
        updateScreenshotBtnVisibility();

        // Fechar modais ao clicar fora
        document.addEventListener('click', (e) => {
            if (e.target === document.getElementById('profileModal')) closeProfileModal();
            if (e.target === document.getElementById('supportModal')) closeSupportModal();
            if (e.target === document.getElementById('teamModal')) closeTeamModal();
        });
    });

    /* ==========================================================
       CARREGAR EQUIPES (GRUPO A‚ÄëD) DIN√ÇMICO
    =========================================================== */
    async function loadTeamData() {
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTI602SZCvv3Vljbau78ZXFxNxUVQATWF1aefTd0rxh6zXpmhV9nDjmpimnDO5vkHLKpWZl82Kw4Gu2/pub?gid=1758023886&single=true&output=csv';
        try {
            const resp = await fetch(csvUrl);
            const txt = await resp.text();
            const rows = Papa.parse(txt, { header: true }).data;

            const groups = { 'GRUPO A': [], 'GRUPO B': [], 'GRUPO C': [], 'GRUPO D': [] };
            rows.forEach(r => {
                const grp = r['GRUPOS']?.trim();
                const nome = r['NOMES']?.trim();
                const turno = r['TURNO']?.trim() || 'T√©cnico';
                if (grp && nome && groups[grp]) {
                    groups[grp].push({ name: nome, role: turno });
                }
            });
            teamData = groups;
            console.log('Equipes carregadas:', teamData);
        } catch (err) {
            console.error('Erro ao ler planilha de equipes:', err);
            // Fallback: deixa vazia, mas mant√©m a UI funcional
            teamData = { 'GRUPO A': [], 'GRUPO B': [], 'GRUPO C': [], 'GRUPO D': [] };
        }
    }

    /* ==========================================================
       CARREGAR USU√ÅRIOS DIN√ÇMICO
    =========================================================== */
    async function loadUsers() {
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTI602SZCvv3Vljbau78ZXFxNxUVQATWF1aefTd0rxh6zXpmhV9nDjmpimnDO5vkHLKpWZl82Kw4Gu2/pub?gid=1605075317&single=true&output=csv';
        try {
            const resp = await fetch(csvUrl);
            const txt = await resp.text();
            const rows = Papa.parse(txt, { header: true }).data;

            // Mant√©m apenas as colunas relevantes
            usersData = rows.map(r => ({
                usuario: r['Usu√°rio']?.trim(),
                nomeCompleto: r['Nome_Completo']?.trim(),
                email: r['Email']?.trim(),
                telefone: r['Telefone']?.trim(),
                tipo: r['Tipo']?.trim(),
                ativo: (r['Ativo']?.trim().toUpperCase() === 'SIM')
            })).filter(u => u.usuario);   // remove linhas vazias

            // Preencher tabela HTML
            const tbody = document.getElementById('usuarios-table');
            tbody.innerHTML = '';
            usersData.forEach(u => {
                const cor = u.ativo ? 'green' : 'orange';
                const txtStatus = u.ativo ? 'Ativo' : 'Inativo';
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${u.usuario}</td>
                    <td>${u.nomeCompleto || '-'}</td>
                    <td>${u.email || '-'}</td>
                    <td>${u.telefone || '-'}</td>
                    <td>${u.tipo || '-'}</td>
                    <td><span style="color:${cor};font-weight:bold;">${txtStatus}</span></td>
                `;
                tbody.appendChild(tr);
            });

            // Definir usu√°rio logado (sessionStorage criado pelo login)
            setLoggedUserProfile();
        } catch (err) {
            console.error('Erro ao ler planilha de usu√°rios:', err);
            document.getElementById('usuarios-table').innerHTML = `<tr><td colspan="6" style="text-align:center;color:#f55;">Erro ao carregar usu√°rios.</td></tr>`;
        }
    }

    function setLoggedUserProfile() {
        const stored = sessionStorage.getItem('vlt_user');
        if (!stored) return;   // nenhum login encontrado
        const loginInfo = JSON.parse(stored);
        const match = usersData.find(u => u.usuario === loginInfo.usuario);
        if (!match) return;    // usu√°rio n√£o encontrado na planilha

        // Atualiza canto superior direito
        const initials = match.nomeCompleto?.split(' ').map(p => p[0]).join('').substring(0,2) || '??';
        document.getElementById('userName').textContent = match.nomeCompleto || match.usuario;
        document.getElementById('userRole').textContent = match.tipo || '';
        document.getElementById('userInitials').textContent = initials;

        // Atualiza modal de perfil
        document.getElementById('perfil-nome').textContent = match.nomeCompleto || '-';
        document.getElementById('perfil-usuario').textContent = match.usuario;
        document.getElementById('perfil-email').textContent = match.email || '-';
        document.getElementById('perfil-telefone').textContent = match.telefone || '-';
        document.getElementById('perfil-tipo').textContent = match.tipo || '-';
        document.getElementById('perfil-status').textContent = match.ativo ? 'Ativo' : 'Inativo';
    }

    /* ==========================================================
       PLANT√ÉO ‚Äì L√ìGICA DE ESCALA 2√ó2
    =========================================================== */
    function setTodayDate() {
        const today = new Date();
        const iso = today.toISOString().split('T')[0];
        document.getElementById('plantao-date').value = iso;
        selectedDate = today;
        updatePlantaoInfo();
    }

    function updatePlantaoInfo() {
        const dateStr = document.getElementById('plantao-date').value;
        if (!dateStr) return;
        selectedDate = new Date(dateStr);

        const diffDays = Math.floor((selectedDate - baseDate) / (1000 * 60 * 60 * 24));
        const remainder = ((diffDays % 4) + 4) % 4;   // garante positivo

        let diurnoGroup, noturnoGroup;
        if (remainder === 0 || remainder === 1) {
            diurnoGroup = 'GRUPO B';
            noturnoGroup = 'GRUPO C';
        } else {
            diurnoGroup = 'GRUPO A';
            noturnoGroup = 'GRUPO D';
        }

        document.getElementById('diurno-group').textContent = diurnoGroup;
        document.getElementById('noturno-group').textContent = noturnoGroup;
        generateCalendar();   // atualiza calend√°rio
    }

    function generateCalendar() {
        const grid = document.getElementById('calendar-grid');
        const title = document.getElementById('calendar-title');

        grid.innerHTML = '';
        const monthNames = ['Janeiro','Fevereiro','Mar√ßo','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
        title.textContent = `${monthNames[calendarMonth]} ${calendarYear}`;

        // Cabe√ßalhos dos dias da semana
        const week = ['Dom','Seg','Ter','Qua','Qui','Sex','S√°b'];
        week.forEach(d => {
            const h = document.createElement('div');
            h.className = 'calendar-day-header';
            h.textContent = d;
            grid.appendChild(h);
        });

        const firstDay = new Date(calendarYear, calendarMonth, 1).getDay(); // 0 = domingo
        const daysInMonth = new Date(calendarYear, calendarMonth + 1, 0).getDate();
        const daysPrevMonth = new Date(calendarYear, calendarMonth, 0).getDate();

        // dias do m√™s anterior (preenchimento)
        for (let i = firstDay - 1; i >= 0; i--) {
            const cell = document.createElement('div');
            cell.className = 'calendar-day other-month';
            cell.innerHTML = `
                <div class="calendar-day-number">${daysPrevMonth - i}</div>
                <div class="calendar-day-shifts"><div class="calendar-day-diurno"></div><div class="calendar-day-noturno"></div></div>
            `;
            grid.appendChild(cell);
        }

        // dias do m√™s corrente
        for (let d = 1; d <= daysInMonth; d++) {
            const date = new Date(calendarYear, calendarMonth, d);
            const iso = date.toISOString().split('T')[0];
            const today = new Date();
            const isToday = date.toDateString() === today.toDateString();
            const isSelected = date.toDateString() === selectedDate.toDateString();

            // c√°lculo do grupo para este dia
            const diff = Math.floor((date - baseDate) / (1000 * 60 * 60 * 24));
            const rem = ((diff % 4) + 4) % 4;
            const diurno = (rem === 0 || rem === 1) ? 'GRUPO B' : 'GRUPO A';
            const noturno = (rem === 0 || rem === 1) ? 'GRUPO C' : 'GRUPO D';

            const membersDiurno = teamData[diurno] ? teamData[diurno].map(m=>m.name).join(', ') : '';
            const membersNoturno = teamData[noturno] ? teamData[noturno].map(m=>m.name).join(', ') : '';

            const cell = document.createElement('div');
            cell.className = 'calendar-day';
            if (isToday) cell.classList.add('today');
            if (isSelected) cell.classList.add('selected');

            cell.innerHTML = `
                <div class="calendar-day-number">${d}</div>
                <div class="calendar-day-shifts">
                    <div class="calendar-day-diurno" title="${diurno}: ${membersDiurno}"></div>
                    <div class="calendar-day-noturno" title="${noturno}: ${membersNoturno}"></div>
                </div>
            `;

            // click ‚Üí altera data selecionada
            cell.addEventListener('click', () => {
                document.getElementById('plantao-date').value = iso;
                selectedDate = date;
                updatePlantaoInfo();
            });

            grid.appendChild(cell);
        }

        // preencher at√© completar 5 semanas (35 dias vis√≠veis)
        const total = grid.children.length - 7; // menos cabe√ßalhos
        const needed = 35 - total;
        for (let i = 1; i <= needed; i++) {
            const cell = document.createElement('div');
            cell.className = 'calendar-day other-month';
            cell.innerHTML = `
                <div class="calendar-day-number">${i}</div>
                <div class="calendar-day-shifts"><div class="calendar-day-diurno"></div><div class="calendar-day-noturno"></div></div>
            `;
            grid.appendChild(cell);
        }
    }

    function changeMonth(delta) {
        calendarMonth += delta;
        if (calendarMonth < 0) { calendarMonth = 11; calendarYear--; }
        else if (calendarMonth > 11) { calendarMonth = 0; calendarYear++; }
        generateCalendar();
    }

    function showTeamDetails(shift) {
        const diurno = document.getElementById('diurno-group').textContent;
        const noturno = document.getElementById('noturno-group').textContent;
        const group = shift === 'diurno' ? diurno : noturno;
        const subtitle = shift === 'diurno' ? 'Turno Diurno' : 'Turno Noturno';
        const iconClass = shift === 'diurno' ? 'fa-sun' : 'fa-moon';
        const iconColor = shift === 'diurno' ? 'diurno' : 'noturno';

        document.getElementById('team-modal-title').textContent = group;
        document.getElementById('team-modal-subtitle').textContent = subtitle;
        document.getElementById('team-modal-icon').className = `team-modal-icon ${iconColor}`;
        document.getElementById('team-modal-icon').innerHTML = `<i class="fas ${iconClass}"></i>`;

        const container = document.getElementById('team-members');
        container.innerHTML = '';
        if (teamData[group]) {
            teamData[group].forEach(m => {
                const el = document.createElement('div');
                el.className = 'team-member';
                const initials = m.name.split(' ').map(p=>p[0]).join('').substring(0,2);
                el.innerHTML = `
                    <div class="member-avatar">${initials}</div>
                    <div class="member-info">
                        <div class="member-name">${m.name}</div>
                        <div class="member-role">${m.role}</div>
                    </div>
                `;
                container.appendChild(el);
            });
        } else {
            container.innerHTML = `<p style="text-align:center;color:#666;">Nenhum membro encontrado.</p>`;
        }
        document.getElementById('teamModal').classList.add('show');
    }
    function closeTeamModal() { document.getElementById('teamModal').classList.remove('show'); }

    /* ==========================================================
       DOCUMENTOS ‚Äì LISTAR SOMENTE PDFs
    =========================================================== */
    async function loadDocuments() {
        const jsonUrl = 'pdf/index.json';   // arquivo a ser criado na raiz/pasta pdf/
        try {
            const resp = await fetch(jsonUrl);
            const docs = await resp.json();
            const container = document.getElementById('documents-list');
            container.innerHTML = '';
            docs.forEach(d => {
                const card = document.createElement('div');
                card.className = 'document-card';
                card.innerHTML = `
                    <div class="document-icon"><i class="fas fa-file-pdf"></i></div>
                    <div class="document-title">${d.title}</div>
                    <div class="document-info">${d.desc}</div>
                    <div class="document-meta">
                        <span class="document-type">PDF</span> ‚Ä¢
                        <span class="document-size">${d.size}</span> ‚Ä¢
                        <span class="document-date">${d.date}</span>
                    </div>
                    <div class="document-actions">
                        <button class="document-btn view" onclick="viewDocument('pdf/${d.file}')"><i class="fas fa-eye"></i> Visualizar</button>
                        <button class="document-btn download" onclick="downloadDocument('pdf/${d.file}')"><i class="fas fa-download"></i> Download</button>
                    </div>
                `;
                container.appendChild(card);
            });
        } catch (e) {
            console.error('Erro ao carregar documentos:', e);
            document.getElementById('documents-list').innerHTML = `<p style="text-align:center;color:#f55;">N√£o foi poss√≠vel carregar os documentos.</p>`;
        }
    }

    function viewDocument(url) {
        window.open(url, '_blank');
    }
    function downloadDocument(url) {
        const a = document.createElement('a');
        a.href = url;
        a.download = url.split('/').pop();
        a.click();
    }

    function filterDocuments() {
        const term = document.getElementById('searchDocumentacao').value.toLowerCase();
        document.querySelectorAll('.document-card').forEach(card => {
            const title = card.querySelector('.document-title').textContent.toLowerCase();
            const info  = card.querySelector('.document-info').textContent.toLowerCase();
            card.style.display = (title.includes(term) || info.includes(term)) ? 'block' : 'none';
        });
    }
    function clearDocumentSearch() {
        document.getElementById('searchDocumentacao').value = '';
        document.querySelectorAll('.document-card').forEach(c => c.style.display = 'block');
    }

    /* ==========================================================
       REL√ìGIO DE OPERA√á√ÉO CONT√çNUA
    =========================================================== */
    function startOperationClock() {
        const start = new Date('2016-06-06T00:00:00');
        function tick() {
            const now = new Date();
            const diff = now - start;
            const years = Math.floor(diff / (1000*60*60*24*365.25));
            const months = Math.floor((diff % (1000*60*60*24*365.25)) / (1000*60*60*24*30.44));
            const days = Math.floor((diff % (1000*60*60*24*30.44)) / (1000*60*60*24));
            const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
            const minutes = Math.floor((diff % (1000*60*60)) / (1000*60));
            const seconds = Math.floor((diff % (1000*60)) / 1000);
            document.getElementById('op-years').textContent = years;
            document.getElementById('op-months').textContent = months;
            document.getElementById('op-days').textContent = days;
            document.getElementById('op-hours').textContent = hours;
            document.getElementById('op-minutes').textContent = minutes;
            document.getElementById('op-seconds').textContent = seconds;
        }
        tick();
        setInterval(tick, 1000);
    }

    /* ==========================================================
       PASSAGEM DE SERVI√áO (filtros simulados)
    =========================================================== */
    function openPassagemFilterModal() { document.getElementById('passagem-filters').style.display = 'flex'; }
    function applyPassagemFilters() {
        const table = document.getElementById('passagem-table');
        table.innerHTML = `<tr><td colspan="7" style="text-align:center;padding:40px;" class="loading">‚è≥ Carregando dados filtrados‚Ä¶</td></tr>`;
        // Simula√ß√£o: aqui voc√™ faria fetch da planilha de registro + filtros
        setTimeout(() => {
            const mock = [
                { data: '24/11/2025 08:30', tecnico: 'Gelson J√∫nior', trem: '001', sistema: 'Tra√ß√£o', descricao: 'Manuten√ß√£o preventiva realizada', status: 'LIBERADO' },
                { data: '24/11/2025 10:15', tecnico: 'Danilo Quintino', trem: '002', sistema: 'Freio', descricao: 'Substitui√ß√£o de pastilhas', status: 'MANUTEN√á√ÉO' },
                { data: '24/11/2025 14:45', tecnico: 'Andr√© Luiz', trem: '003', sistema: 'Portas', descricao: 'Ajuste de sensor', status: 'AGENDADO' },
                { data: '24/11/2025 16:20', tecnico: 'Rafael Camilo', trem: '004', sistema: 'Comunica√ß√£o', descricao: 'Falha de comunica√ß√£o', status: 'COLIS√ÉO' }
            ];
            table.innerHTML = '';
            mock.forEach(r => {
                const tr = document.createElement('tr');
                const color = {
                    'LIBERADO':'green','MANUTEN√á√ÉO':'orange','AGENDADO':'blue','COLIS√ÉO':'red','PREVENTIVA':'purple'
                }[r.status] || 'gray';
                tr.innerHTML = `
                    <td>${r.data}</td>
                    <td>${r.tecnico}</td>
                    <td>${r.trem}</td>
                    <td>${r.sistema}</td>
                    <td>${r.descricao}</td>
                    <td><span style="color:${color};font-weight:bold;">${r.status}</span></td>
                `;
                table.appendChild(tr);
            });
        }, 1500);
    }
    function clearPassagemFilters() {
        ['passagemData','passagemGrupo','passagemTrem','passagemSistema','passagemTecnico','passagemStatus']
            .forEach(id => document.getElementById(id).value = '');
        applyPassagemFilters();
    }

    /* ==========================================================
       BUSCA DE ESTA√á√ïES (dados simulados)
    =========================================================== */
    function searchStation() {
        const term = document.getElementById('searchEstacao').value.toLowerCase();
        const out = document.getElementById('estacao-result');
        if (term.length < 2) { out.innerHTML=''; return; }
        const stations = [
            { name:'Candel√°ria', code:'CAN', line:'1' },
            { name:'Sete de Setembro', code:'SS', line:'1' },
            { name:'Carioca', code:'CAR', line:'1' },
            { name:'Uruguai', code:'URU', line:'1' },
            { name:'Santos Dumont', code:'SD', line:'2' },
            { name:'Parada dos Museus', code:'PMU', line:'2' },
            { name:'Cinelandia', code:'CIN', line:'2' },
            { name:'Presidente Vargas', code:'PV', line:'3' },
            { name:'Pra√ßa XV', code:'PXV', line:'4' }
        ];
        const hits = stations.filter(s => s.name.toLowerCase().includes(term) || s.code.toLowerCase().includes(term));
        if (!hits.length) {
            out.innerHTML = '<p style="color:#666;">Nenhuma esta√ß√£o encontrada</p>';
            return;
        }
        let html = '<div class="estacoes-list">';
        hits.forEach(s => {
            html += `<div class="estacao-item highlight"><strong>${s.name}</strong> (${s.code})<br><small>Linha ${s.line}</small></div>`;
        });
        html += '</div>';
        out.innerHTML = html;
    }

    function showLineStations(line) {
        const lines = {
            1:['Candel√°ria','Sete de Setembro','Carioca','Uruguai'],
            2:['Santos Dumont','Parada dos Museus','Cinelandia'],
            3:['Carioca','Presidente Vargas'],
            4:['Pra√ßa XV','Parada dos Museus']
        };
        const arr = lines[line] || [];
        const div = document.getElementById('linhas-list');
        if (!arr.length) { div.style.display='none'; return; }
        let html = `<div style="margin-bottom:10px;"><strong>Linha ${line}</strong></div><div class="estacoes-list">`;
        arr.forEach(s => html += `<div class="estacao-item">${s}</div>`);
        html += '</div>';
        div.innerHTML = html;
        div.style.display = 'block';
    }

    /* ==========================================================
       CAPTURA DE TELA (html2canvas + download png / pdf)
    =========================================================== */
    function takeScreenshot() {
        const element = document.querySelector('.content');
        html2canvas(element).then(canvas => {
            const img = canvas.toDataURL('image/png');
            const pdf = new jsPDF('p','mm','a4');
            const imgProps = pdf.getImageProperties(img);
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
            pdf.addImage(img,'PNG',0,0,pdfWidth,pdfHeight);
            pdf.save(`dashboard_${new Date().toISOString().split('T')[0]}.pdf`);
            alert('Screenshot capturada com sucesso!');
        });
    }
    function takePageScreenshot(page) {
        const element = document.getElementById(`page-${page}`);
        html2canvas(element).then(c => {
            const img = c.toDataURL('image/png');
            const a = document.createElement('a');
            a.href = img;
            a.download = `${page}_${new Date().toISOString().split('T')[0]}.png`;
            a.click();
            alert(`Screenshot da p√°gina "${page}" feita!`);
        });
    }
    function takePassagemScreenshot() { takePageScreenshot('passagem'); }

    /* ==========================================================
       MODAIS DE PERFIL / SUPORTE
    =========================================================== */
    function openProfileModal() { document.getElementById('profileModal').classList.add('show'); }
    function closeProfileModal() { document.getElementById('profileModal').classList.remove('show'); }
    function openSupportModal() { document.getElementById('supportModal').classList.add('show'); }
    function closeSupportModal() { document.getElementById('supportModal').classList.remove('show'); }
    function editProfile() { alert('Fun√ß√£o edi√ß√£o de perfil ainda n√£o implementada.'); }
    function changePassword() { alert('Fun√ß√£o de troca de senha ainda n√£o implementada.'); }
    function logout() {
        if (confirm('Deseja sair do sistema?')) {
            sessionStorage.removeItem('vlt_user');
            window.location.href = 'index.html';   // volta para tela de login
        }
    }
    function openTicketForm() { alert('Formul√°rio de abertura de chamado ainda n√£o implementado.'); }

    /* ==========================================================
       Navega√ß√£o entre p√°ginas
    =========================================================== */
    function toggleSidebar() {
        document.querySelector('.sidebar').classList.toggle('collapsed');
    }

    function showPage(pageId, ev) {
        // Esconde todas
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        const target = document.getElementById(`page-${pageId}`);
        if (target) target.classList.add('active');
        else document.getElementById('page-dashboard').classList.add('active');

        // Marca nav ativo
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        if (ev && ev.currentTarget) ev.currentTarget.classList.add('active');

        // Breadcrumb
        const names = {
            dashboard:'üìä Dashboard',
            plantao:'üìÖ Plant√£o',
            passagem:'üìã Passagem de Servi√ßo',
            novo_registro:'‚ûï Novo Registro',
            usuarios:'üë• Usu√°rios',
            laboratorio:'üî¨ Laborat√≥rio',
            eva:'ü§ñ EVA',
            refrigeracao:'‚ùÑÔ∏è Refrigera√ß√£o',
            rastreabilidade:'üõ£Ô∏è Rastreabilidade',
            programacao:'üìÖ Programa√ß√£o Semanal',
            documentacao:'üìí Documenta√ß√£o',
            sobre:'‚ÑπÔ∏è Sobre o VLT'
        };
        document.getElementById('breadcrumb').textContent = names[pageId] || pageId;

        // Atualiza visibilidade do bot√£o de captura
        updateScreenshotBtnVisibility();
    }

    function updateScreenshotBtnVisibility() {
        const btn = document.getElementById('screenshotBtn');
        if (!btn) return;
        // Mostrar em todas as p√°ginas (exceto Dashboard que j√° tem outro m√©todo)
        const hideOn = []; // se quiser esconder em alguma p√°gina basta colocar o id aqui
        btn.style.display = hideOn.includes(currentPage) ? 'none' : 'block';
    }

    /* ==========================================================
       IFRAME FALLBACK (caso bloqueado)
    =========================================================== */
    function handleIframeLoad(id) { document.getElementById(id).classList.add('hidden'); }
    function handleIframeError(pageId, fallbackUrl) {
        const container = document.getElementById(pageId);
        if (!container) return;
        container.innerHTML = `
            <div class="fallback-container">
                <div class="fallback-message">
                    <p>O formul√°rio n√£o p√¥de ser carregado. Isso pode acontecer por restri√ß√µes do navegador.</p>
                    <p>Clique no bot√£o abaixo para abrir o formul√°rio em outra aba.</p>
                </div>
                <a href="${fallbackUrl}" target="_blank" class="fallback-btn"><i class="fas fa-external-link-alt"></i> Abrir Formul√°rio</a>
            </div>`;
    }

    /* ==========================================================
       VERIFICA√á√ïES DE BIBLIOTECAS (fallback caso falhe)
    =========================================================== */
    window.addEventListener('load', () => {
        const needed = ['html2canvas','XLSX','jsPDF'];
        needed.forEach(lib => {
            if (typeof window[lib]==='undefined') console.warn(`Biblioteca ${lib} n√£o carregada ‚Äì alguma funcionalidade pode ficar indispon√≠vel.`);
        });
    });

</script>
</body>
</html>
