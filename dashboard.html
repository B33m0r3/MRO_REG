<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard VLT Carioca</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --light: #f5f7fa;
            --dark: #2c3e50;
            --border: #e0e6ed;
            --success: #4facfe;
            --danger: #f5576c;
            --warning: #ffa726;
            --info: #29b6f6;
            --azul-linha: #0055A4;
            --verde-linha: #00A651;
            --amarelo-linha: #FFC400;
            --laranja-linha: #F37335;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            position: relative;
            overflow: hidden;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://www.transparenttextures.com/patterns/cubes.png'), linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            z-index: -1;
        }
        .container { display: flex; height: 100vh; }
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px 20px;
            overflow-y: auto;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: width 0.3s ease;
            position: relative;
            z-index: 100;
        }
        .sidebar.collapsed { width: 80px; padding: 20px 10px; }
        .sidebar.collapsed .nav-label, .sidebar.collapsed .logo span { display: none; }
        .sidebar.collapsed .nav-item { justify-content: center; }
        .toggle-sidebar {
            position: absolute;
            top: 30px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 18px;
            transition: transform 0.3s;
        }
        .sidebar.collapsed .toggle-sidebar { transform: rotate(180deg); }
        .logo {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .logo i { font-size: 32px; color: var(--primary); }
        .nav-menu { list-style: none; }
        .nav-item {
            padding: 12px 16px;
            margin: 8px 0;
            border-radius: 6px;
            cursor: pointer;
            color: rgba(255,255,255,0.7);
            transition: all 0.3s;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .nav-item:hover, .nav-item.active {
            background: rgba(102,126,234,0.2);
            color: white;
            border-left-color: var(--primary);
        }
        .nav-item i { width: 20px; min-width: 20px; }
        .nav-label { display: inline; }
        .nav-divider { height: 1px; background: rgba(255,255,255,0.1), margin: 20px 0; }
        .main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .top-bar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .breadcrumb { color: var(--dark); font-size: 16px; font-weight: 600; }
        .top-right { display: flex; gap: 20px; align-items: center; }
        .screenshot-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        .screenshot-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(102,126,234,0.4); }
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 6px;
            transition: background 0.3s;
        }
        .user-profile:hover { background: var(--light); }
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .user-info { font-size: 13px; }
        .user-name { font-weight: 600; color: var(--dark); }
        .user-role { color: #7f8c8d; font-size: 11px; }
        .content { flex: 1; overflow-y: auto; padding: 30px; position: relative; display: flex; flex-direction: column; }
        .pages-wrapper { flex: 1; overflow-y: auto; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .page-header { margin-bottom: 30px; }
        .page-header h1 { font-size: 28px; color: var(--dark); margin-bottom: 5px; }
        .page-header p { color: var(--dark); font-size: 14px; font-weight: 500; }
        /* Loading */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            border-radius: 8px;
        }
        .loading-overlay.hidden { display: none; }
        .spinner {
            border: 5px solid var(--border);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        /* Filtros Relat√≥rios */
        .filter-container { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; align-items: center; }
        .filter-input, .filter-select {
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
            background: white;
        }
        .filter-input:focus, .filter-select:focus { outline: none; border-color: var(--primary); }
        .filter-btn {
            padding: 10px 20px;
            background: white;
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s;
        }
        .filter-btn:hover, .filter-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
        /* Tabelas */
        .table-container { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 8px; overflow-x: auto; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; font-size:13px; }
        thead { background: var(--light); }
        th { padding: 15px; text-align: left; font-weight: 600; color: var(--dark); border-bottom: 2px solid var(--border); }
        td { padding: 12px 15px; border-bottom: 1px solid var(--border); }
        tr:hover { background: var(--light); }
        /* Bot√µes */
        .btn-primary {
            padding: 15px 30px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
        }
        .btn-primary:hover { transform: translateY(-2px); }
        .btn-primary i { margin-right: 8px; }
        .center-content { text-align: center; padding: 60px 20px; }
        /* Modais */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        .modal.show { display: flex; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #bdc3c7;
            transition: color 0.3s;
        }
        .modal-close:hover { color: var(--dark); }
        .modal-title { font-size: 24px; font-weight: 600; margin-bottom: 30px; color: var(--dark); }
        .modal-section { margin-bottom: 25px; }
        .modal-label { font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase; margin-bottom: 8px; }
        .modal-value { font-size: 16px; color: var(--dark); font-weight: 600; }
        .modal-link { display: inline-block; color: var(--primary); text-decoration: none; cursor: pointer; font-weight: 600; }
        .modal-link:hover { color: var(--secondary); }
        /* Aba Sobre VLT */
        .sobre-container { display: flex; gap: 30px; }
        .sobre-map { flex: 1; }
        .sobre-map img { width: 100%; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .sobre-info { flex: 1; }
        .info-card { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .info-card h3 { color: var(--dark); margin-bottom: 15px; }
        .info-card p { color: #555; line-height: 1.6; }
        .search-box { width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 6px; font-size: 14px; margin-bottom: 20px; }
        .linha-btn { padding: 10px 15px; border: none; border-radius: 6px; color: white; font-weight: 600; cursor: pointer; margin: 5px; transition: transform 0.2s; }
        .linha-btn:hover { transform: scale(1.05); }
        .linha-azul { background-color: var(--azul-linha); }
        .linha-verde { background-color: var(--verde-linha); }
        .linha-amarela { background-color: var(--amarelo-linha); }
        .linha-laranja { background-color: var(--laranja-linha); }
        .estacoes-list { max-height: 200px; overflow-y: auto; border: 1px solid var(--border); border-radius: 6px; padding: 10px; }
        .estacao-item { padding: 8px; border-bottom: 1px solid #eee; cursor: pointer; transition: background 0.2s; }
        .estacao-item:hover { background: var(--light); }
        .estacao-item.highlight { background: #fff3cd; font-weight: bold; }
        /* Rel√≥gio de Opera√ß√£o */
        .operation-clock {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .operation-clock h2 { font-size: 20px; margin-bottom: 10px; font-weight: 700; }
        .clock-display { font-size: 28px; font-weight: 700; font-family: 'Courier New', Courier, monospace; }
        .clock-display span { margin: 0 5px; }
        /* Resumo Passagem - REMOVIDO conforme solicitado */
        .resumo-passagem { display: none; }
        .motivational-quote {
            margin-top: auto;
            padding-top: 30px;
            border-top: 2px solid var(--border);
            text-align: center;
            color: var(--dark);
            font-style: italic;
            font-size: 16px;
            font-weight: 600;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.5);
            border-radius: 8px;
        }
        .loading { color: var(--primary); }
        /* Estilos para Documenta√ß√£o */
        .documents-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .document-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary);
            cursor: pointer;
        }
        .document-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .document-icon {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 15px;
        }
        .document-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            line-height: 1.4;
        }
        .document-info {
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 15px;
        }
        .document-actions {
            display: flex;
            gap: 10px;
        }
        .document-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s;
            flex: 1;
            text-align: center;
        }
        .document-btn.view {
            background: var(--primary);
            color: white;
        }
        .document-btn.download {
            background: var(--success);
            color: white;
        }
        .document-btn:hover {
            transform: translateY(-2px);
        }
        /* Estilos para formul√°rios embutidos */
        .form-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            position: relative;
            min-height: 850px;
        }
        .form-iframe {
            width: 100%;
            height: 800px;
            border: none;
            display: block;
        }
        .tabs-container {
            display: flex;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px 8px 0 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 0;
        }
        .tab-btn {
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.8);
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s;
            flex: 1;
        }
        .tab-btn.active {
            background: white;
            border-bottom-color: var(--primary);
            color: var(--primary);
        }
        .tab-content {
            display: none;
            padding: 20px;
            background: white;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .tab-content.active {
            display: block;
        }
        /* Estilos para a aba Cat√°logo */
        .catalogo-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .catalogo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .catalogo-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--dark);
        }
        .catalogo-actions {
            display: flex;
            gap: 10px;
        }
        .catalogo-main {
            display: flex;
            flex: 1;
            gap: 20px;
        }
        .catalogo-sidebar {
            width: 30%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            overflow-y: auto;
        }
        .catalogo-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .catalogo-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px 8px 0 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 0;
        }
        .catalogo-tab {
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.8);
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s;
            flex: 1;
        }
        .catalogo-tab.active {
            background: white;
            border-bottom-color: var(--primary);
            color: var(--primary);
        }
        .catalogo-tab-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 0 0 8px 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 20px;
            flex: 1;
            overflow-y: auto;
        }
        .catalogo-search {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 15px;
        }
        .catalogo-filter-group {
            margin-bottom: 15px;
        }
        .catalogo-filter-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            display: block;
        }
        .catalogo-filter-select {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
            background: white;
        }
        .catalogo-filter-select:focus {
            outline: none;
            border-color: var(--primary);
        }
        .catalogo-tree {
            margin-top: 15px;
        }
        .catalogo-tree-item {
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .catalogo-tree-item:hover {
            background: var(--light);
        }
        .catalogo-tree-item.selected {
            background: rgba(102, 126, 234, 0.2);
            color: var(--primary);
            font-weight: 600;
        }
        .catalogo-tree-toggle {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        .catalogo-tree-children {
            margin-left: 20px;
            margin-top: 5px;
            display: none;
        }
        .catalogo-tree-children.show {
            display: block;
        }
        .catalogo-details {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        .catalogo-details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .catalogo-details-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
        }
        .catalogo-details-actions {
            display: flex;
            gap: 10px;
        }
        .catalogo-details-content {
            display: flex;
            gap: 20px;
        }
        .catalogo-details-info {
            flex: 1;
        }
        .catalogo-details-image {
            width: 300px;
            height: 300px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .catalogo-details-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .catalogo-details-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .catalogo-details-table th {
            padding: 10px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid var(--border);
            background: var(--light);
        }
        .catalogo-details-table td {
            padding: 10px;
            border-bottom: 1px solid var(--border);
        }
        .catalogo-material-table {
            width: 100%;
            border-collapse: collapse;
        }
        .catalogo-material-table th {
            padding: 10px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid var(--border);
            background: var(--light);
        }
        .catalogo-material-table td {
            padding: 10px;
            border-bottom: 1px solid var(--border);
        }
        .catalogo-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }
        .catalogo-pagination-btn {
            padding: 8px 12px;
            background: white;
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s;
        }
        .catalogo-pagination-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .catalogo-pagination-info {
            font-size: 14px;
            color: var(--dark);
        }
        /* Estilos para a aba Plant√£o */
        .plantao-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .plantao-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .plantao-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--dark);
        }
        .plantao-date-selector {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .plantao-date-input {
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        .plantao-date-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        .plantao-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        .plantao-shift {
            flex: 1;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            transition: transform 0.3s;
            cursor: pointer;
        }
        .plantao-shift:hover {
            transform: translateY(-5px);
        }
        .plantao-diurno {
            background: linear-gradient(135deg, #FFC400, #FFD54F);
            color: #333;
            margin-right: 10px;
        }
        .plantao-noturno {
            background: linear-gradient(135deg, #0055A4, #1976D2);
            color: white;
            margin-left: 10px;
        }
        .plantao-shift-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .plantao-shift-time {
            font-size: 14px;
            margin-bottom: 15px;
            opacity: 0.8;
        }
        .plantao-shift-group {
            font-size: 20px;
            font-weight: 700;
            padding: 10px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.2);
        }
        .plantao-calendar {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .calendar-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
        }
        .calendar-nav {
            display: flex;
            gap: 10px;
        }
        .calendar-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--light);
            border: none;
            color: var(--dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        .calendar-btn:hover {
            background: var(--primary);
            color: white;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }
        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            color: var(--dark);
            padding: 10px 0;
        }
        .calendar-day {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            background: var(--light);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .calendar-day:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .calendar-day-number {
            font-weight: 600;
            margin-bottom: 5px;
        }
        .calendar-day-shifts {
            display: flex;
            width: 100%;
            height: 6px;
        }
        .calendar-day-diurno {
            height: 100%;
            width: 50%;
            background-color: #FFC400;
            border-radius: 3px 0 0 3px;
        }
        .calendar-day-noturno {
            height: 100%;
            width: 50%;
            background-color: #0055A4;
            border-radius: 0 3px 3px 0;
        }
        .calendar-day.other-month {
            opacity: 0.3;
        }
        .calendar-day.today {
            border: 2px solid var(--primary);
        }
        .calendar-day.selected {
            border: 2px solid var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }
        /* Modal para detalhes da equipe */
        .team-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        .team-modal.show { display: flex; animation: fadeIn 0.3s ease; }
        .team-modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            position: relative;
        }
        .team-modal-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .team-modal-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 24px;
        }
        .team-modal-icon.diurno {
            background: linear-gradient(135deg, #FFC400, #FFD54F);
        }
        .team-modal-icon.noturno {
            background: linear-gradient(135deg, #0055A4, #1976D2);
        }
        .team-modal-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--dark);
        }
        .team-modal-subtitle {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        .team-members {
            margin-top: 20px;
        }
        .team-member {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }
        .team-member:last-child {
            border-bottom: none;
        }
        .member-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: var(--dark);
            font-weight: 600;
        }
        .member-info {
            flex: 1;
        }
        .member-name {
            font-weight: 600;
            color: var(--dark);
        }
        .member-role {
            font-size: 12px;
            color: #7f8c8d;
        }
        /* Estilos para a aba Programa√ß√£o Semanal */
        .programacao-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .programacao-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .programacao-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--dark);
        }
        .programacao-actions {
            display: flex;
            gap: 10px;
        }
        .programacao-iframe-container {
            width: 100%;
            height: 600px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            position: relative;
        }
        .programacao-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        @media (max-width: 768px) {
            .top-bar { padding: 12px 15px; }
            .screenshot-btn { padding: 6px 12px; font-size: 12px; }
            .user-info { display: none; }
            .content { padding: 15px; }
            .page-header h1 { font-size: 20px; }
            .filter-container { flex-direction: column; }
            .filter-btn { width: 100%; }
            .sobre-container { flex-direction: column; }
            .documents-container { grid-template-columns: 1fr; }
            .form-iframe { height: 600px; }
            .catalogo-main { flex-direction: column; }
            .catalogo-sidebar { width: 100%; }
            .catalogo-details-content { flex-direction: column; }
            .catalogo-details-image { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <button class="toggle-sidebar" onclick="toggleSidebar()">‚óÄ</button>
            <div class="logo">
                <i class="fas fa-train"></i>
                <span>VLT Carioca</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" onclick="showPage('dashboard', event)">
                    <i class="fas fa-chart-line"></i>
                    <span class="nav-label">Dashboard</span>
                </li>
                <li class="nav-item" onclick="showPage('plantao', event)">
                    <i class="fas fa-calendar-alt"></i>
                    <span class="nav-label">Plant√£o</span>
                </li>
                <li class="nav-item" onclick="showPage('passagem', event)">
                    <i class="fas fa-clipboard-list"></i>
                    <span class="nav-label">Passagem de Servi√ßo</span>
                </li>
                <li class="nav-item" onclick="showPage('novo_registro', event)">
                    <i class="fas fa-plus-circle"></i>
                    <span class="nav-label">Novo Registro</span>
                </li>
                <li class="nav-item" onclick="showPage('usuarios', event)" id="usuarios-menu">
                    <i class="fas fa-users"></i>
                    <span class="nav-label">Usu√°rios</span>
                </li>
                <li class="nav-item" onclick="showPage('laboratorio', event)">
                    <i class="fas fa-flask"></i>
                    <span class="nav-label">Laborat√≥rio</span>
                </li>
                <li class="nav-item" onclick="showPage('eva', event)">
                    <i class="fas fa-robot"></i>
                    <span class="nav-label">EVA</span>
                </li>
                <li class="nav-item" onclick="showPage('refrigeracao', event)">
                    <i class="fas fa-snowflake"></i>
                    <span class="nav-label">Refrigera√ß√£o</span>
                </li>
                <li class="nav-item" onclick="showPage('rastreabilidade', event)">
                    <i class="fas fa-route"></i>
                    <span class="nav-label">Rastreabilidade</span>
                </li>
                <li class="nav-item" onclick="showPage('programacao', event)">
                    <i class="fas fa-calendar-week"></i>
                    <span class="nav-label">Programa√ß√£o Semanal</span>
                </li>
                <li class="nav-item" onclick="showPage('documentacao', event)">
                    <i class="fas fa-book"></i>
                    <span class="nav-label">Documenta√ß√£o</span>
                </li>
                <li class="nav-item" onclick="showPage('catalogo', event)">
                    <i class="fas fa-folder-open"></i>
                    <span class="nav-label">Cat√°logo</span>
                </li>
                <li class="nav-item" onclick="showPage('sobre', event)">
                    <i class="fas fa-info-circle"></i>
                    <span class="nav-label">Sobre o VLT</span>
                </li>
                <li class="nav-item" onclick="openSupportModal()">
                    <i class="fas fa-headset"></i>
                    <span class="nav-label">Suporte</span>
                </li>
            </ul>
        </aside>
        <main class="main">
            <div class="top-bar">
                <div class="breadcrumb" id="breadcrumb">üìä Dashboard</div>
                <div class="top-right">
                    <button class="screenshot-btn" id="screenshotBtn" style="display:block;" onclick="takeScreenshot()">
                        <i class="fas fa-camera"></i> Screenshot
                    </button>
                    <div class="user-profile" onclick="openProfileModal()">
                        <div class="user-avatar" id="userInitials">JS</div>
                        <div class="user-info">
                            <div class="user-name" id="userName">Jo√£o Silva</div>
                            <div class="user-role" id="userRole">Administrador</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content">
                <div class="pages-wrapper">
                    <!-- Dashboard -->
                    <div class="page active" id="page-dashboard">
                        <div class="cards-container" id="dashboard-cards"></div>
                        <div style="width: 100%; height: 600px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 20px; position: relative;">
                            <div class="loading-overlay" id="loading-looker">
                                <div class="spinner"></div>
                            </div>
                            <iframe src="https://lookerstudio.google.com/embed/reporting/95cf4b2a-b4ef-4aa1-910c-423461799e6c" frameborder="0" style="border: 0; width: 100%; height: 100%;" onload="document.getElementById('loading-looker').classList.add('hidden')" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>
                        </div>
                    </div>
                    <!-- Plant√£o -->
                    <div class="page" id="page-plantao">
                        <div class="page-header">
                            <h1>üìÖ Plant√£o</h1>
                            <p>Visualiza√ß√£o da escala de trabalho 2x2</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <button class="btn-primary" onclick="takePageScreenshot('plantao')">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="plantao-container">
                            <div class="plantao-header">
                                <div class="plantao-title">Escala de Plant√£o</div>
                                <div class="plantao-date-selector">
                                    <input type="date" id="plantao-date" class="plantao-date-input" onchange="updatePlantaoInfo()">
                                    <button class="btn-primary" onclick="setTodayDate()">Hoje</button>
                                </div>
                            </div>
                            <div class="plantao-info">
                                <div class="plantao-shift plantao-diurno" onclick="showTeamDetails('diurno')">
                                    <div class="plantao-shift-title">Turno Diurno</div>
                                    <div class="plantao-shift-time">06:00 - 18:00</div>
                                    <div class="plantao-shift-group" id="diurno-group">GRUPO B</div>
                                </div>
                                <div class="plantao-shift plantao-noturno" onclick="showTeamDetails('noturno')">
                                    <div class="plantao-shift-title">Turno Noturno</div>
                                    <div class="plantao-shift-time">18:00 - 06:00</div>
                                    <div class="plantao-shift-group" id="noturno-group">GRUPO C</div>
                                </div>
                            </div>
                            <div class="plantao-calendar">
                                <div class="calendar-header">
                                    <div class="calendar-title" id="calendar-title">Novembro 2023</div>
                                    <div class="calendar-nav">
                                        <button class="calendar-btn" onclick="changeMonth(-1)">
                                            <i class="fas fa-chevron-left"></i>
                                        </button>
                                        <button class="calendar-btn" onclick="changeMonth(1)">
                                            <i class="fas fa-chevron-right"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="calendar-grid" id="calendar-grid">
                                    <!-- Calendar will be generated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Passagem de Servi√ßo -->
                    <div class="page" id="page-passagem">
                        <div class="page-header">
                            <h1>üìã Passagem de Servi√ßo</h1>
                            <p>Resumo do plant√£o. Use o filtro para carregar os dados corretos.</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <button class="btn-primary" onclick="openPassagemFilterModal()">
                                <i class="fas fa-filter"></i> Filtrar Passagem de Servi√ßo
                            </button>
                            <a href="https://docs.google.com/spreadsheets/d/13G8eUT2m35aoWsqpIu3OTKUdg0L2sdjEl0GTXfPEg50/edit?usp=sharing" target="_blank" class="btn-primary" style="margin-left: 10px;">
                                <i class="fas fa-table"></i> Acessar Planilha
                            </a>
                            <button class="btn-primary" onclick="takePageScreenshot('passagem')" style="margin-left: 10px;">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="filter-container" id="passagem-filters" style="display: none;">
                            <input type="date" id="passagemData" class="filter-input" placeholder="Selecione a data">
                            <select id="passagemGrupo" class="filter-select">
                                <option value="">Todos Grupos</option>
                                <option value="GRUPO A">GRUPO A</option>
                                <option value="GRUPO B">GRUPO B</option>
                                <option value="GRUPO C">GRUPO C</option>
                                <option value="GRUPO D">GRUPO D</option>
                            </select>
                            <input type="text" id="passagemTrem" class="filter-input" placeholder="N√∫mero do Trem">
                            <input type="text" id="passagemSistema" class="filter-input" placeholder="Sistema">
                            <input type="text" id="passagemTecnico" class="filter-input" placeholder="T√©cnico">
                            <select id="passagemStatus" class="filter-select">
                                <option value="">Todos Status</option>
                                <option value="LIBERADO">LIBERADO</option>
                                <option value="MANUTEN√á√ÉO">MANUTEN√á√ÉO</option>
                                <option value="AGENDADO">AGENDADO</option>
                                <option value="COLIS√ÉO">COLIS√ÉO</option>
                                <option value="PREVENTIVA">PREVENTIVA</option>
                            </select>
                            <button class="filter-btn" onclick="applyPassagemFilters()">
                                <i class="fas fa-filter"></i> Aplicar Filtros
                            </button>
                            <button class="filter-btn" onclick="clearPassagemFilters()">
                                <i class="fas fa-times"></i> Limpar
                            </button>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Carimbo de data/hora</th>
                                        <th>NOME E SOBRENOME</th>
                                        <th>MATRICULA</th>
                                        <th>GRUPO</th>
                                        <th>TURNO</th>
                                        <th>DATA DA FAHA</th>
                                        <th>N√öMERO DO TREM</th>
                                        <th>SISTEMAS</th>
                                        <th>C√ìDIGO IOS DA FALHA</th>
                                        <th>DESCRI√á√ÉO DETALHADA</th>
                                        <th>EVID√äNCIAS</th>
                                        <th>STATUS ATUAL DO TREM</th>
                                        <th>ORDEM DE SERVI√áO</th>
                                        <th>N√öMERO DA ORDEM DE SERVI√áO</th>
                                        <th>Endere√ßo de e-mail</th>
                                    </tr>
                                </thead>
                                <tbody id="passagem-table">
                                    <tr><td colspan="15" style="text-align: center; padding: 40px;">Clique no bot√£o "Filtrar Passagem de Servi√ßo" para carregar os dados.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- Novo Registro -->
                    <div class="page" id="page-novo_registro">
                        <div class="page-header">
                            <h1>‚ûï Novo Registro</h1>
                            <p>Registre uma nova falha ou evento no sistema</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vTI602SZCvv3Vljbau78ZXFxNxUVQATWF1aefTd0rxh6zXpmhV9nDjmpimnDO5vkHLKpWZl82Kw4Gu2/pub?gid=195449004&single=true&output=csv" target="_blank" class="btn-primary">
                                <i class="fas fa-table"></i> Acessar Planilha
                            </a>
                            <button class="btn-primary" onclick="takePageScreenshot('novo_registro')" style="margin-left: 10px;">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="form-container">
                            <div class="loading-overlay" id="loading-novo_registro">
                                <div class="spinner"></div>
                            </div>
                            <iframe 
                                src="https://docs.google.com/forms/d/e/1FAIpQLSdz056J8dsQMPXV6__U2B-VOxQEaNF34bwyaRgFVlcCKOLZ_Q/viewform?embedded=true" 
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-novo_registro')"
                                onerror="handleIframeError('page-novo_registro', 'https://docs.google.com/forms/d/e/1FAIpQLSdz056J8dsQMPXV6__U2B-VOxQEaNF34bwyaRgFVlcCKOLZ_Q/viewform')"
                            ></iframe>
                        </div>
                    </div>
                    <!-- Usu√°rios -->
                    <div class="page" id="page-usuarios">
                        <div class="page-header">
                            <h1>üë• Usu√°rios do Sistema</h1>
                            <p>Lista de usu√°rios cadastrados e seus perfis</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vTI602SZCvv3Vljbau78ZXFxNxUVQATWF1aefTd0rxh6zXpmhV9nDjmpimnDO5vkHLKpWZl82Kw4Gu2/pubhtml?gid=1605075317&single=true" target="_blank" class="btn-primary">
                                <i class="fas fa-table"></i> Acessar Planilha
                            </a>
                            <button class="btn-primary" onclick="takePageScreenshot('usuarios')" style="margin-left: 10px;">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Usu√°rio</th>
                                        <th>Nome</th>
                                        <th>Email</th>
                                        <th>Telefone</th>
                                        <th>Tipo</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="usuarios-table">
                                    <tr><td colspan="6" style="text-align: center; padding: 40px;" class="loading">‚è≥ Carregando usu√°rios...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- Laborat√≥rio -->
                    <div class="page" id="page-laboratorio">
                        <div class="page-header">
                            <h1>üî¨ Laborat√≥rio</h1>
                            <p>Registros e atividades da equipe de laborat√≥rio</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=43329994&single=true&output=csv" target="_blank" class="btn-primary">
                                <i class="fas fa-table"></i> Acessar Planilha
                            </a>
                            <button class="btn-primary" onclick="takePageScreenshot('laboratorio')" style="margin-left: 10px;">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="form-container">
                            <div class="loading-overlay" id="loading-laboratorio">
                                <div class="spinner"></div>
                            </div>
                            <iframe 
                                src="https://docs.google.com/forms/d/e/1FAIpQLSeX0zKXBJXX3SyCkJGHufqbEDlTnpRigdZq0TmBqdLmC3woGQ/viewform?embedded=true" 
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-laboratorio')"
                                onerror="handleIframeError('page-laboratorio', 'https://docs.google.com/forms/d/e/1FAIpQLSeX0zKXBJXX3SyCkJGHufqbEDlTnpRigdZq0TmBqdLmC3woGQ/viewform')"
                            ></iframe>
                        </div>
                    </div>
                    <!-- EVA -->
                    <div class="page" id="page-eva">
                        <div class="page-header">
                            <h1>ü§ñ EVA</h1>
                            <p>Registros e atividades da equipe EVA</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=927195938&single=true&output=csv" target="_blank" class="btn-primary">
                                <i class="fas fa-table"></i> Acessar Planilha
                            </a>
                            <button class="btn-primary" onclick="takePageScreenshot('eva')" style="margin-left: 10px;">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="form-container">
                            <div class="loading-overlay" id="loading-eva">
                                <div class="spinner"></div>
                            </div>
                            <iframe 
                                src="https://docs.google.com/forms/d/e/1FAIpQLSeixWIcnMdFmqHnxwO-vb2F86AKW6g6KRqDwMsYTk3Baj6l8w/viewform?embedded=true" 
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-eva')"
                                onerror="handleIframeError('page-eva', 'https://docs.google.com/forms/d/e/1FAIpQLSeixWIcnMdFmqHnxwO-vb2F86AKW6g6KRqDwMsYTk3Baj6l8w/viewform')"
                            ></iframe>
                        </div>
                    </div>
                    <!-- Refrigera√ß√£o -->
                    <div class="page" id="page-refrigeracao">
                        <div class="page-header">
                            <h1>‚ùÑÔ∏è Refrigera√ß√£o</h1>
                            <p>Registros e atividades da equipe de refrigera√ß√£o</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=131107120&single=true&output=csv" target="_blank" class="btn-primary">
                                <i class="fas fa-table"></i> Acessar Planilha
                            </a>
                            <button class="btn-primary" onclick="takePageScreenshot('refrigeracao')" style="margin-left: 10px;">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="form-container">
                            <div class="loading-overlay" id="loading-refrigeracao">
                                <div class="spinner"></div>
                            </div>
                            <iframe 
                                src="https://docs.google.com/forms/d/e/1FAIpQLSekQ4e_rCSuzitRhtpjq48VR2ttobQvvRr--e0qcTH5PU9azQ/viewform?embedded=true" 
                                class="form-iframe"
                                allow="clipboard-read; clipboard-write"
                                allowfullscreen
                                loading="lazy"
                                onload="handleIframeLoad('loading-refrigeracao')"
                                onerror="handleIframeError('page-refrigeracao', 'https://docs.google.com/forms/d/e/1FAIpQLSekQ4e_rCSuzitRhtpjq48VR2ttobQvvRr--e0qcTH5PU9azQ/viewform')"
                            ></iframe>
                        </div>
                    </div>
                    <!-- Rastreabilidade -->
                    <div class="page" id="page-rastreabilidade">
                        <div class="page-header">
                            <h1>üîç Rastreabilidade</h1>
                            <p>Sistema de rastreabilidade de componentes</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <button class="btn-primary" onclick="takePageScreenshot('rastreabilidade')">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="center-content">
                            <p>Funcionalidade em desenvolvimento</p>
                        </div>
                    </div>
                    <!-- Programa√ß√£o Semanal -->
                    <div class="page" id="page-programacao">
                        <div class="page-header">
                            <h1>üìÖ Programa√ß√£o Semanal</h1>
                            <p>Visualiza√ß√£o da programa√ß√£o semanal de atividades</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=1564591852&single=true&output=csv" target="_blank" class="btn-primary">
                                <i class="fas fa-table"></i> Acessar Planilha Online
                            </a>
                            <button class="btn-primary" onclick="takePageScreenshot('programacao')" style="margin-left: 10px;">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="programacao-container">
                            <div class="programacao-header">
                                <div class="programacao-title">Programa√ß√£o Semanal</div>
                                <div class="programacao-actions">
                                    <button class="btn-primary" onclick="refreshProgramacao()">
                                        <i class="fas fa-sync-alt"></i> Atualizar
                                    </button>
                                </div>
                            </div>
                            <div class="programacao-iframe-container">
                                <iframe 
                                    src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQh0a-BMomvvOomRWYGlmoZSPG6ZuwF1jRXFrm8yhzMzizB9vWBgFiFBRyFBRRHQfVVoRppT3E8FBKS/pub?gid=1564591852&single=true&output=csv" 
                                    class="programacao-iframe"
                                    allowfullscreen
                                    loading="lazy"
                                ></iframe>
                            </div>
                        </div>
                    </div>
                    <!-- Documenta√ß√£o -->
                    <div class="page" id="page-documentacao">
                        <div class="page-header">
                            <h1>üìö Documenta√ß√£o</h1>
                            <p>Documentos t√©cnicos e manuais do sistema VLT</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <button class="btn-primary" onclick="takePageScreenshot('documentacao')">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="documents-container" id="documents-container">
                            <!-- Documents will be loaded here -->
                        </div>
                    </div>
                    <!-- Cat√°logo -->
                    <div class="page" id="page-catalogo">
                        <div class="page-header">
                            <h1>üìÇ Cat√°logo</h1>
                            <p>Cat√°logo de pe√ßas e componentes do VLT</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <button class="btn-primary" onclick="takePageScreenshot('catalogo')">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="catalogo-container">
                            <div class="catalogo-main">
                                <div class="catalogo-sidebar">
                                    <div class="catalogo-filter-group">
                                        <label class="catalogo-filter-label">Pesquisar</label>
                                        <input type="text" id="catalogo-search" class="catalogo-search" placeholder="Buscar componente...">
                                    </div>
                                    <div class="catalogo-filter-group">
                                        <label class="catalogo-filter-label">Filtrar por</label>
                                        <select id="catalogo-filter-type" class="catalogo-filter-select">
                                            <option value="">Todos</option>
                                            <option value="sistema">Sistema</option>
                                            <option value="material">Material</option>
                                        </select>
                                    </div>
                                    <div class="catalogo-tree" id="catalogo-tree">
                                        <!-- Tree will be generated here -->
                                    </div>
                                </div>
                                <div class="catalogo-content">
                                    <div class="catalogo-tabs">
                                        <button class="catalogo-tab active" onclick="showCatalogoTab('sistema')">Sistema/Equipamento</button>
                                        <button class="catalogo-tab" onclick="showCatalogoTab('material')">Base Cadastro</button>
                                    </div>
                                    <div class="catalogo-tab-content active" id="catalogo-sistema">
                                        <div class="catalogo-details" id="catalogo-sistema-details">
                                            <div class="catalogo-details-header">
                                                <div class="catalogo-details-title">Selecione um componente</div>
                                                <div class="catalogo-details-actions">
                                                    <button class="btn-primary" onclick="exportCatalogoSistema()">
                                                        <i class="fas fa-download"></i> Exportar
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="catalogo-details-content">
                                                <div class="catalogo-details-info">
                                                    <p>Selecione um componente na √°rvore √† esquerda para visualizar seus detalhes.</p>
                                                </div>
                                                <div class="catalogo-details-image">
                                                    <img src="https://via.placeholder.com/300" alt="Componente">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="catalogo-tab-content" id="catalogo-material">
                                        <div class="catalogo-details" id="catalogo-material-details">
                                            <div class="catalogo-details-header">
                                                <div class="catalogo-details-title">Base de Cadastro</div>
                                                <div class="catalogo-details-actions">
                                                    <button class="btn-primary" onclick="exportCatalogoMaterial()">
                                                        <i class="fas fa-download"></i> Exportar
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="table-container">
                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th>Centro</th>
                                                            <th>Material</th>
                                                            <th>Texto breve de material</th>
                                                            <th>Texto Longo</th>
                                                            <th>Dep√≥sito</th>
                                                            <th>Utiliza√ß√£o livre</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="catalogo-material-table">
                                                        <tr><td colspan="6" style="text-align: center; padding: 40px;">Carregando dados...</td></tr>
                                                    </tbody>
                                                </table>
                                                <div class="catalogo-pagination">
                                                    <button class="catalogo-pagination-btn" onclick="previousMaterialPage()">
                                                        <i class="fas fa-chevron-left"></i>
                                                    </button>
                                                    <div class="catalogo-pagination-info">
                                                        P√°gina <span id="material-current-page">1</span> de <span id="material-total-pages">1</span>
                                                    </div>
                                                    <button class="catalogo-pagination-btn" onclick="nextMaterialPage()">
                                                        <i class="fas fa-chevron-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Sobre -->
                    <div class="page" id="page-sobre">
                        <div class="page-header">
                            <h1>‚ÑπÔ∏è Sobre o VLT</h1>
                            <p>Informa√ß√µes sobre o sistema VLT Carioca</p>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <button class="btn-primary" onclick="takePageScreenshot('sobre')">
                                <i class="fas fa-camera"></i> Capturar Tela
                            </button>
                        </div>
                        <div class="sobre-container">
                            <div class="sobre-map">
                                <img src="https://via.placeholder.com/600x400" alt="Mapa VLT">
                            </div>
                            <div class="sobre-info">
                                <div class="info-card">
                                    <h3>Sobre o VLT Carioca</h3>
                                    <p>O Ve√≠culo Leve sobre Trilhos (VLT) Carioca √© um sistema de transporte p√∫blico moderno que conecta diversas regi√µes do Rio de Janeiro, oferecendo uma alternativa eficiente e sustent√°vel para o deslocamento de passageiros.</p>
                                </div>
                                <div class="info-card">
                                    <h3>Especifica√ß√µes T√©cnicas</h3>
                                    <ul>
                                        <li>Modelo: Citadis 402</li>
                                        <li>Fabricante: Alstom</li>
                                        <li>Comprimento: 43 metros</li>
                                        <li>Capacidade: 420 passageiros</li>
                                        <li>Velocidade m√°xima: 70 km/h</li>
                                    </ul>
                                </div>
                                <div class="info-card">
                                    <h3>Linhas</h3>
                                    <div style="margin-bottom: 10px;">
                                        <button class="linha-btn linha-azul">Linha 1</button>
                                        <button class="linha-btn linha-verde">Linha 2</button>
                                        <button class="linha-btn linha-amarela">Linha 3</button>
                                        <button class="linha-btn linha-laranja">Linha 4</button>
                                    </div>
                                    <div class="estacoes-list" id="estacoes-list">
                                        <!-- Lista de esta√ß√µes -->
                                        <div class="estacao-item">Carioca</div>
                                        <div class="estacao-item">Uruguai</div>
                                        <div class="estacao-item">Saara</div>
                                        <div class="estacao-item">Presidente Vargas</div>
                                        <div class="estacao-item">Cinelandia</div>
                                        <div class="estacao-item">Santos Dumont</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modais -->
    <div class="modal" id="supportModal">
        <div class="modal-content">
            <button class="modal-close" onclick="document.getElementById('supportModal').classList.remove('show')">&times;</button>
            <h2 class="modal-title">Central de Suporte</h2>
            <p>Em caso de d√∫vidas ou problemas, entre em contato com o suporte t√©cnico.</p>
            <div style="margin-top: 20px;">
                <p><strong>Email:</strong> suporte@vltcarioca.com.br</p>
                <p><strong>Telefone:</strong> (21) 99999-9999</p>
            </div>
        </div>
    </div>

    <div class="modal" id="profileModal">
        <div class="modal-content">
            <button class="modal-close" onclick="document.getElementById('profileModal').classList.remove('show')">&times;</button>
            <h2 class="modal-title">Meu Perfil</h2>
            <div class="modal-section">
                <div class="modal-label">Nome</div>
                <div class="modal-value" id="profileName">Jo√£o Silva</div>
            </div>
            <div class="modal-section">
                <div class="modal-label">Cargo</div>
                <div class="modal-value" id="profileRole">Administrador</div>
            </div>
            <div class="modal-section">
                <div class="modal-label">Email</div>
                <div class="modal-value">joao.silva@vltcarioca.com.br</div>
            </div>
            <div class="modal-section">
                <div class="modal-label">Telefone</div>
                <div class="modal-value">(21) 98765-4321</div>
            </div>
            <div style="margin-top: 30px; text-align: center;">
                <button class="btn-primary" onclick="document.getElementById('profileModal').classList.remove('show')">
                    Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts JavaScript -->
    <script>
        // Fun√ß√£o para alternar entre as abas do menu
        function showPage(pageId, event) {
            // Remove classe "active" de todos os itens do menu
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Adiciona classe "active" ao item clicado
            if (event) {
                event.currentTarget.classList.add('active');
            }
            
            // Esconde todas as p√°ginas
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Mostra a p√°gina selecionada
            document.getElementById('page-' + pageId).classList.add('active');
            
            // Atualiza o t√≠tulo no topo da p√°gina (breadcrumb)
            const pageTitles = {
                'dashboard': 'üìä Dashboard',
                'plantao': 'üìÖ Plant√£o',
                'passagem': 'üìã Passagem de Servi√ßo',
                'novo_registro': '‚ûï Novo Registro',
                'usuarios': 'üë• Usu√°rios',
                'laboratorio': 'üî¨ Laborat√≥rio',
                'eva': 'ü§ñ EVA',
                'refrigeracao': '‚ùÑÔ∏è Refrigera√ß√£o',
                'rastreabilidade': 'üîç Rastreabilidade',
                'programacao': 'üìÖ Programa√ß√£o Semanal',
                'documentacao': 'üìö Documenta√ß√£o',
                'catalogo': 'üìÇ Cat√°logo',
                'sobre': '‚ÑπÔ∏è Sobre o VLT'
            };
            
            document.getElementById('breadcrumb').textContent = pageTitles[pageId] || pageId;
        }

        // Fun√ß√£o para carregar informa√ß√µes do usu√°rio no perfil
        function loadUserProfile() {
            // Aqui voc√™ pode substituir por dados reais do seu sistema
            const user = {
                name: 'Jo√£o Silva',
                role: 'Administrador',
                initials: 'JS'
            };
            
            // Atualiza os elementos com as informa√ß√µes do usu√°rio
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userRole').textContent = user.role;
            document.getElementById('userInitials').textContent = user.initials;
            
            // Tamb√©m atualiza o modal do perfil
            document.getElementById('profileName').textContent = user.name;
            document.getElementById('profileRole').textContent = user.role;
        }

        // Fun√ß√£o para alternar menu lateral (abrir/fechar)
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('collapsed');
        }

        // Fun√ß√µes para os bot√µes de a√ß√£o
        function takeScreenshot() {
            alert('Captura de tela iniciada! Esta fun√ß√£o pode ser aprimorada.');
        }
        
        function openSupportModal() {
            document.getElementById('supportModal').classList.add('show');
        }
        
        function openProfileModal() {
            document.getElementById('profileModal').classList.add('show');
        }

        // Fun√ß√µes para iframes (formul√°rios)
        function handleIframeLoad(loadingId) {
            document.getElementById(loadingId).classList.add('hidden');
        }
        
        function handleIframeError(pageId, fallbackUrl) {
            console.error('Erro ao carregar iframe na p√°gina: ' + pageId);
            alert('Erro ao carregar conte√∫do. Tentando recarregar...');
            // Aqui voc√™ poderia redirecionar para uma URL alternativa
        }

        // Fun√ß√£o para capturar tela de uma p√°gina espec√≠fica
        function takePageScreenshot(pageName) {
            alert('Capturando tela da p√°gina: ' + pageName);
        }

        // Inicializa√ß√£o quando a p√°gina carrega
        document.addEventListener('DOMContentLoaded', function() {
            // Carrega o perfil do usu√°rio
            loadUserProfile();
            
            // Fecha modais ao clicar fora deles
            window.onclick = function(event) {
                if (event.target.className === 'modal') {
                    event.target.classList.remove('show');
                }
            };
            
            // Configurar data atual para o campo de data do plant√£o
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('plantao-date').value = today;
        });

        // Fun√ß√µes adicionais para o filtro de passagem de servi√ßo
        function openPassagemFilterModal() {
            document.getElementById('passagem-filters').style.display = 'flex';
        }
        
        function applyPassagemFilters() {
            alert('Filtros aplicados! Em uma vers√£o completa, aqui filtrar√≠amos os dados.');
        }
        
        function clearPassagemFilters() {
            document.getElementById('passagem-filters').style.display = 'none';
        }
        
        // Fun√ß√µes para a aba Plant√£o
        function updatePlantaoInfo() {
            const date = document.getElementById('plantao-date').value;
            // Aqui iria a l√≥gica para atualizar as informa√ß√µes do plant√£o com base na data
            alert('Atualizando informa√ß√µes para: ' + date);
        }
        
        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('plantao-date').value = today;
            updatePlantaoInfo();
        }
        
        function showTeamDetails(shiftType) {
            alert('Mostrando detalhes da equipe do turno ' + (shiftType === 'diurno' ? 'diurno' : 'noturno'));
        }
        
        function changeMonth(direction) {
            // L√≥gica para mudar o m√™s no calend√°rio
            const currentTitle = document.getElementById('calendar-title').textContent;
            alert('Mudando m√™s: ' + (direction > 0 ? 'pr√≥ximo' : 'anterior') + ' - ' + currentTitle);
        }
        
        // Fun√ß√µes para a aba Cat√°logo
        function showCatalogoTab(tabName) {
            document.querySelectorAll('.catalogo-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.catalogo-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelector(`.catalogo-tab[onclick="showCatalogoTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`catalogo-${tabName}`).classList.add('active');
        }
        
        function exportCatalogoSistema() {
            alert('Exportando dados do cat√°logo de sistema/equipamento');
        }
        
        function exportCatalogoMaterial() {
            alert('Exportando dados da base de cadastro');
        }
        
        function previousMaterialPage() {
            // L√≥gica para p√°gina anterior
            alert('P√°gina anterior');
        }
        
        function nextMaterialPage() {
            // L√≥gica para pr√≥xima p√°gina
            alert('Pr√≥xima p√°gina');
        }
        
        // Fun√ß√£o para atualizar programa√ß√£o
        function refreshProgramacao() {
            alert('Atualizando programa√ß√£o semanal');
        }
    </script>
</body>
</html>
